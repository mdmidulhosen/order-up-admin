"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[2624],{11101:function(e,n,i){var l=i(34344),d={getAll:function(e){return l.Z.get("rest/brands/paginate",{params:e})},getById:function(e,n){return l.Z.get("rest/brands/".concat(e),{params:n})}};n.Z=d},29955:function(e,n,i){var l=i(34344),d={getAll:function(e){return l.Z.get("dashboard/seller/categories/paginate",{params:e})},getById:function(e,n){return l.Z.get("dashboard/seller/categories/".concat(e),{params:n})},search:function(e){return l.Z.get("dashboard/seller/categories/search",{params:e})},paginateSelect:function(e){return l.Z.get("dashboard/seller/categories/select-paginate",{params:e})}};n.Z=d},2624:function(e,n,i){i.r(n),i.d(n,{default:function(){return He}});var l=i(47313),d=i(15508),r=i(68197),t=i(59624),o=i(15861),a=i(29439),s=i(87757),u=i.n(s),c=i(77181),v=i(89281),p=i(11101),m=i(29955),h=i(80314),x=i(2717),f=i(95882),y=i(41481),Z=i(24511),j=i(46417),g=function(){var e=(0,Z.$)().t,n=(0,x.I0)(),i=(0,l.useState)(null),d=(0,a.Z)(i,2),s=d[0],g=d[1],b=(0,l.useState)(null),_=(0,a.Z)(b,2),k=_[0],N=_[1],w=(0,l.useState)(null),q=(0,a.Z)(w,2),C=q[0],I=q[1],S=(0,x.v9)((function(e){return e.myShop}),x.wU).myShop;function A(){return(A=(0,o.Z)(u().mark((function e(n){var i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={search:0===(null===n||void 0===n?void 0:n.length)?null:n},e.abrupt("return",p.Z.getAll(i).then((function(e){return e.data.map((function(e){return{label:null===e||void 0===e?void 0:e.title,value:null===e||void 0===e?void 0:e.id}}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return F=(0,o.Z)(u().mark((function e(n){var i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={search:0===(null===n||void 0===n?void 0:n.length)?null:n,type:"main"},e.abrupt("return",m.Z.search(i).then((function(e){return e.data.map((function(e){var n;return{label:(null===e||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title)||"no name",value:e.id}}))})));case 2:case"end":return e.stop()}}),e)}))),F.apply(this,arguments)}return(0,h.Z)((function(){var e={brand_id:null===s||void 0===s?void 0:s.value,category_id:null===k||void 0===k?void 0:k.value,search:C,active:1,status:"published"};n((0,f.MW)(e))}),[s,k,C]),(0,j.jsx)(c.Z,{children:(0,j.jsxs)(r.Z,{gutter:12,children:[(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(y.Z,{className:"w-100",placeholder:e("search"),handleChange:I})}),(0,j.jsx)(t.Z,{span:"shop"===S.type?6:12,children:(0,j.jsx)(v.h,{className:"w-100",placeholder:e("select.category"),fetchOptions:function(e){return F.apply(this,arguments)},onChange:function(e){return N(e)},value:k})}),"shop"===S.type?(0,j.jsx)(t.Z,{span:6,children:(0,j.jsx)(v.h,{className:"w-100",placeholder:e("select.brand"),fetchOptions:function(e){return A.apply(this,arguments)},onChange:function(e){return g(e)},value:s})}):void 0]})})},b=i(1413),_=i(72652),k=i(18074),N=i(66909),w=i(82138),q=i(45464),C=i(90954),I=i(23560),S=i(42111),A=i(63226),F=i(58821),Y=i(51988),M=i(97890),D=i(93433),T=i(9274),z=i(59491),V=i(26824),U=i(83371),P=i(45705),B=i(55768),E=i(8846),H=i(84017),O=i(59681),$=i(91220),W=i(28939),L=i(77370),J=i(18333),Q=i(32697),K=function(e){var n,i,l=e.showExtras,d=e.addonCalculate,r=e.selectedValues,t=e.handleChange;return(0,j.jsx)(P.Z,{direction:"vertical",size:"middle",children:null===(n=l.stock)||void 0===n||null===(i=n.addons)||void 0===i?void 0:i.filter((function(e){var n,i;return!!e.product&&!(null===e||void 0===e||null===(n=e.product)||void 0===n||null===(i=n.stock)||void 0===i||!i.quantity)})).map((function(e){var n,i,l=r.includes(String(e.addon_id));return(0,j.jsxs)("div",{children:[(0,j.jsx)(Q.Z,{id:String(e.id),name:String(e.id),checked:l,onChange:function(){return t(e)}}),(0,j.jsxs)("label",{htmlFor:String(e.id),children:[l&&(0,j.jsxs)(P.Z,{size:0,children:[(0,j.jsx)(z.Z,{type:"text",className:"minus-button",style:{padding:0,height:"max-content"},size:"small",icon:(0,j.jsx)(E.Z,{}),disabled:1===e.product.quantity,onClick:function(n){n.stopPropagation(),d(e.addon_id,e.product.quantity-1)}}),(0,j.jsx)("span",{className:"ml-2",children:e.product.quantity||e.product.min_qty}),(0,j.jsx)(z.Z,{type:"text",className:"plus-button",style:{padding:0,height:"max-content"},size:"small",icon:(0,j.jsx)(w.Z,{}),onClick:function(n){n.stopPropagation(),d(e.addon_id,e.product.quantity?e.product.quantity+1:e.product.min_qty+1)}})]}),(0,j.jsx)("span",{className:"ml-2",children:null===(n=e.product)||void 0===n||null===(i=n.translation)||void 0===i?void 0:i.title})]})]},e.id)}))})};function R(e){var n,i,d,o,s,u=e.extrasModal,c=e.setExtrasModal,v=(0,l.useState)(!1),p=(0,a.Z)(v,2),m=p[0],f=p[1],y=(0,l.useState)({}),g=(0,a.Z)(y,2),k=g[0],N=g[1],C=(0,Z.$)().t,S=(0,l.useState)({}),A=(0,a.Z)(S,2),F=A[0],Y=A[1],M=(0,x.I0)(),Q=(0,l.useState)([]),R=(0,a.Z)(Q,2),X=R[0],G=R[1],ee=(0,l.useState)([]),ne=(0,a.Z)(ee,2),ie=ne[0],le=ne[1],de=(0,l.useState)([]),re=(0,a.Z)(de,2),te=re[0],oe=re[1],ae=(0,l.useState)([]),se=(0,a.Z)(ae,2),ue=se[0],ce=se[1],ve=(0,l.useState)([]),pe=(0,a.Z)(ve,2),me=pe[0],he=pe[1],xe=(0,l.useState)({extras:[],stock:{id:0,quantity:1,price:0}}),fe=(0,a.Z)(xe,2),ye=fe[0],Ze=fe[1],je=(0,l.useState)((null===u||void 0===u?void 0:u.quantity)||(null===k||void 0===k?void 0:k.quantity)||(null===k||void 0===k?void 0:k.min_qty)||1),ge=(0,a.Z)(je,2),be=ge[0],_e=ge[1],ke=(0,x.v9)((function(e){return e.cart}),x.wU),Ne=ke.currentBag,we=ke.currency;var qe=function(){return c(!1)};function Ce(e){return(null===ue||void 0===ue?void 0:ue.reduce((function(e,n){var i,l,d,r;return e+((null===n||void 0===n||null===(i=n.product)||void 0===i||null===(l=i.stock)||void 0===l?void 0:l.price)||0)*((null===n||void 0===n||null===(d=n.product)||void 0===d?void 0:d.quantity)||(null===n||void 0===n||null===(r=n.product)||void 0===r?void 0:r.min_qty)||1)}),0))+(null===ye||void 0===ye?void 0:ye.stock)?null===ye||void 0===ye?void 0:ye.stock[e||"price"]:0*be}return(0,h.Z)((function(){var e=ye.stock.addons.filter((function(e){return me.includes(String(e.addon_id))}));ce(e)}),[me]),(0,l.useEffect)((function(){null!==ye&&void 0!==ye&&ye.stock&&Y((0,b.Z)((0,b.Z)({},ye.stock),{},{extras:te}))}),[ye]),(0,l.useEffect)((function(){f(!0),J.Z.getById(u.uuid).then((function(e){var n,i=e.data;N(i);var l,d=(0,L.o)(i,null===u||void 0===u?void 0:u.addons);(G(d.extras),_e(u.quantity||i.quantity||i.min_qty),le(d.stock),Ze((0,L.y)(te,d.extras,d.stock)),null===(n=(0,L.y)("",d.extras,d.stock).extras)||void 0===n||n.forEach((function(e){oe((function(n){return[].concat((0,D.Z)(n),[e[0]])}))})),null!==u&&void 0!==u&&u.addons)&&he((null===u||void 0===u||null===(l=u.addons)||void 0===l?void 0:l.map((function(e){var n;return String((null===e||void 0===e||null===(n=e.countable)||void 0===n?void 0:n.id)||e.countable_id)})))||[])})).finally((function(){return f(!1)}))}),[u.uuid]),(0,j.jsx)(T.Z,{visible:!!k,title:k.name,onCancel:qe,footer:[(0,j.jsx)(z.Z,{icon:(0,j.jsx)(B.Z,{}),type:"primary",onClick:function(){var e=ue.map((function(e){var n,i;return(0,b.Z)((0,b.Z)({},e),{},{stockID:e.product.stock.id,quantity:(null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.quantity)||(null===e||void 0===e||null===(i=e.product)||void 0===i?void 0:i.min_qty)||1})})),n=(0,b.Z)((0,b.Z)({},k),{},{stock:F,quantity:be,id:F.id,img:(0,W.Z)(F)||k.img,bag_id:Ne,stockID:F,addons:e});n.quantity>F.quantity?I.Am.warning("".concat(C("you.cannot.order.more.than")," ").concat(F.quantity)):(M((0,O.Xq)(n)),c(null))},children:C("add")},"add-product"),(0,j.jsx)(z.Z,{type:"default",onClick:qe,children:C("cancel")},"cancel-product")],children:(0,j.jsxs)(_.Z,{spinning:m,children:[(0,j.jsxs)(r.Z,{gutter:24,children:[(0,j.jsx)(t.Z,{span:8,children:(0,j.jsx)(V.Z,{src:(0,q.Z)((0,W.Z)(F)||k.img),alt:k.name,height:200,style:{objectFit:"contain"}})}),(0,j.jsx)(t.Z,{span:16,children:(0,j.jsxs)(U.Z,{title:null===(n=k.translation)||void 0===n?void 0:n.title,children:[(0,j.jsxs)(U.Z.Item,{label:C("price"),span:3,children:[(0,j.jsx)("div",{className:null!==F&&void 0!==F&&F.discount?"strike":"",children:(0,H.Z)(Ce(),null===we||void 0===we?void 0:we.symbol,null===we||void 0===we?void 0:we.position)}),!(null===F||void 0===F||!F.discount)&&(0,j.jsx)("div",{className:"ml-2 font-weight-bold",children:(0,H.Z)(Ce("total_price"),null===we||void 0===we?void 0:we.symbol,null===we||void 0===we?void 0:we.position)})]}),(0,j.jsx)(U.Z.Item,{label:C("in.stock"),span:3,children:(0,$.Z)(null!==(i=null===F||void 0===F?void 0:F.quantity)&&void 0!==i?i:0,k.unit)}),(0,j.jsx)(U.Z.Item,{label:C("tax"),span:3,children:(0,H.Z)(null===F||void 0===F?void 0:F.tax,null===we||void 0===we?void 0:we.symbol,null===we||void 0===we?void 0:we.position)})]})})]}),null===ye||void 0===ye||null===(d=ye.extras)||void 0===d?void 0:d.map((function(e,n){return(0,j.jsx)("div",{className:"extra-group",children:(0,j.jsx)(P.Z,{className:"extras-select",wrap:!0,children:e.map((function(e){return(0,j.jsx)("span",{className:"extras-text rounded ".concat(te.find((function(n){return n.id===e.id}))?"selected":""),onClick:function(){return function(e){var n,i=te.findIndex((function(n){return n.extra_group_id===e.extra_group_id})),l=te;i>-1&&(l=l.slice(0,i)),l.push(e);var d=l.map((function(e){return e.id})).join(","),r=(0,L.y)(d,X,ie);Ze(r),null===(n=r.extras)||void 0===n||n.forEach((function(n){var i=te.findIndex((function(i){return n[0].extra_group_id!=e.extra_group_id?i.extra_group_id===n[0].extra_group_id:i.extra_group_id===e.extra_group_id}));if(n[0].level>=e.level){var d=n[0].extra_group_id!=e.extra_group_id?n[0]:e;-1==i?l.push(d):l[i]=d}})),oe(l)}(e)},children:e.value})}))},"extra-group"+n)})})),(0,j.jsx)(K,{showExtras:ye,selectedValues:me,handleChange:function(e){var n=String(e.addon_id);me.includes(n)?he((function(e){return e.filter((function(e){return e!==n}))})):he((function(e){return[].concat((0,D.Z)(e),[n])}))},addonCalculate:function(e,n){Ze((function(i){return(0,b.Z)((0,b.Z)({},i),{},{stock:(0,b.Z)((0,b.Z)({},i.stock),{},{addons:i.stock.addons.map((function(i){return i.addon_id===e?(0,b.Z)((0,b.Z)({},i),{},{product:(0,b.Z)((0,b.Z)({},i.product),{},{quantity:n})}):i}))})})})),ce((function(i){return i.map((function(i){return i.addon_id===e?(0,b.Z)((0,b.Z)({},i),{},{product:(0,b.Z)((0,b.Z)({},i.product),{},{quantity:n})}):i}))}))}}),(0,j.jsx)(r.Z,{gutter:12,className:"mt-3",children:(0,j.jsx)(t.Z,{span:24,children:(0,j.jsxs)(P.Z,{children:[(0,j.jsx)(z.Z,{type:"primary",icon:(0,j.jsx)(E.Z,{}),onClick:function(){1!==be&&(be<=k.min_qty||_e((function(e){return e-1})))}}),(be||1)*((null===k||void 0===k?void 0:k.interval)||1),null===k||void 0===k||null===(o=k.unit)||void 0===o||null===(s=o.translation)||void 0===s?void 0:s.title,(0,j.jsx)(z.Z,{type:"primary",icon:(0,j.jsx)(w.Z,{}),onClick:function(){be!==(null===k||void 0===k?void 0:k.quantity)&&be!==k.max_qty&&_e((function(e){return e+1}))}})]})})})]})})}function X(){var e,n=(0,Z.$)().t,i={lg:8,xl:6,xxl:6},d=(0,l.useState)(null),o=(0,a.Z)(d,2),s=o[0],u=o[1],v=(0,x.I0)(),p=(0,x.v9)((function(e){return e.product}),x.wU),m=p.products,h=p.loading,y=p.meta,g=p.params,D=(0,x.v9)((function(e){return e.menu}),x.wU).activeMenu,T=(0,x.v9)((function(e){return e.cart}),x.wU).currency,z=(0,x.v9)((function(e){return(0,A.TW)(e.cart)})),V=(0,x.v9)((function(e){return e.globalSettings.settings}),x.wU).before_order_phone_required,U=(0,M.TH)(),P=null===U||void 0===U||null===(e=U.state)||void 0===e?void 0:e.delivery_type;(0,l.useEffect)((function(){D.refetch&&(v((0,f.MW)({perPage:12,currency_id:null===T||void 0===T?void 0:T.id,status:"published",active:1})),v((0,S.dA)({})),v((0,C.A_)(D)))}),[D.refetch]);return(0,j.jsxs)("div",{className:"px-2",children:[h?(0,j.jsx)(_.Z,{className:"d-flex justify-content-center my-5"}):(0,j.jsx)(r.Z,{gutter:12,className:"mt-4 product-card",children:0===m.length?(0,j.jsx)(t.Z,{span:24,children:(0,j.jsx)(Y.Z,{id:"nosell"})}):m.map((function(e,d){var r;return(0,l.createElement)(t.Z,(0,b.Z)((0,b.Z)({},i),{},{key:d}),(0,j.jsxs)(c.Z,{className:"products-col",cover:(0,j.jsx)("img",{alt:e.name,src:(0,q.Z)(e.img)}),onClick:function(){return function(e){var i,l,d,r,t,o,a,s,c;if(T||P){if("dine_in"===(null===z||void 0===z||null===(i=z.deliveries)||void 0===i?void 0:i.value)){var v,p;if(null===z||void 0===z||null===(v=z.deliveryZone)||void 0===v||!v.value)return void I.Am.warning(n("please.select.delivery.zone"));if(null===z||void 0===z||null===(p=z.table)||void 0===p||!p.value)return void I.Am.warning(n("please.select.table"))}"delivery"!==(null===z||void 0===z||null===(l=z.deliveries)||void 0===l?void 0:l.value)||null!==z&&void 0!==z&&null!==(d=z.user)&&void 0!==d&&d.value?"delivery"!==(null===z||void 0===z||null===(r=z.deliveries)||void 0===r?void 0:r.value)||null!==z&&void 0!==z&&z.phone||"1"!==V?"delivery"===(null===z||void 0===z||null===(t=z.deliveries)||void 0===t?void 0:t.value)&&Number(null===z||void 0===z?void 0:z.phone)<0?I.Am.warning(n("invalid.phone.number")):"delivery"!==(null===z||void 0===z||null===(o=z.deliveries)||void 0===o?void 0:o.value)||null!==z&&void 0!==z&&z.address||P?null!==z&&void 0!==z&&z.paymentType||P?"delivery"!==(null===z||void 0===z||null===(a=z.deliveries)||void 0===a?void 0:a.value)||z.deliveries||P?"delivery"!==(null===z||void 0===z||null===(s=z.deliveries)||void 0===s?void 0:s.value)||null!==z&&void 0!==z&&z.delivery_date||P?"delivery"!==(null===z||void 0===z||null===(c=z.deliveries)||void 0===c?void 0:c.value)||null!==z&&void 0!==z&&z.delivery_time||P?u(e):I.Am.warning(n("please.select.delivery.time")):I.Am.warning(n("please.select.delivery.date")):I.Am.warning(n("please.select.delivery")):I.Am.warning(n("please.select.payment.type")):I.Am.warning(n("please.select.address")):I.Am.warning(n("please.enter.phone")):I.Am.warning(n("please.select.user"))}else I.Am.warning(n("please.select.currency"))}(e)},children:[(0,j.jsx)(N.Z,{title:e.name,description:null===(r=e.stock)||void 0===r?void 0:r.price}),(0,j.jsx)("div",{className:"preview",children:(0,j.jsx)(w.Z,{})}),e.stocks.map((function(e){var n,i;return(0,j.jsxs)("span",{className:e.bonus?"show-bonus":"d-none",children:[(0,j.jsx)(F.ojn,{})," ",null===(n=e.bonus)||void 0===n?void 0:n.value,"+",null===(i=e.bonus)||void 0===i?void 0:i.bonus_quantity]})}))]},e.id))}))}),s&&(0,j.jsx)(R,{extrasModal:s,setExtrasModal:u}),(0,j.jsx)("div",{className:"d-flex justify-content-end my-5",children:(0,j.jsx)(k.Z,{total:y.total,current:g.page,pageSize:12,showSizeChanger:!1,onChange:function(e){v((0,f.MW)({perPage:12,page:e,status:"published",active:1}))},active:1})})]})}var G=i(10976),ee=i(16124),ne=i(74294),ie=i(66461),le=i(11829),de=i(40200),re=i(58328),te=i(16031),oe=i(89802),ae=i(20637),se=i(70816),ue=i.n(se),ce=i(99096),ve=i(34344),pe={getAll:function(e){return ve.Z.get("dashboard/seller/user-addresses",{params:e})},create:function(e){return ve.Z.post("dashboard/seller/user-addresses",e)}},me=i(49655),he=i(82528),xe=i(73459),fe=i(16895),ye=i(97388),Ze=i(17649),je=i(52838),ge=i(19107),be=i(97421);function _e(e){var n=e.uuid,i=e.handleCancel,d=e.parentForm,r=(0,Z.$)().t,t=G.Z.useForm(),s=(0,a.Z)(t,1)[0],c=(0,x.I0)(),v=(0,x.v9)((function(e){return(0,A.TW)(e.cart)})),p=(0,x.v9)((function(e){return e.cart}),x.wU).currentBag,m=(0,x.v9)((function(e){return e.globalSettings}),x.wU).settings,h=(0,l.useState)((function(){if(d){var e=d.getFieldsValue().location;return null!==e&&void 0!==e&&e[0]?{lat:null===e||void 0===e?void 0:e[0],lng:null===e||void 0===e?void 0:e[1]}:(0,Ze.Z)(m)}return v.address?{lat:v.address.lat,lng:v.address.lng}:(0,Ze.Z)(m)})),f=(0,a.Z)(h,2),y=f[0],g=f[1],_=(0,l.useState)(""),k=(0,a.Z)(_,2),N=k[0],w=k[1],q=(0,je.Z)({apiKey:be.kr,libraries:["places","geocode"]}),C=q.placePredictions,I=q.getPlacePredictions,S=q.isPlacePredictionsLoading;return(0,l.useEffect)((function(){if(d){var e=d.getFieldsValue();s.setFieldsValue({address:e.address.address})}else s.setFieldsValue({address:v.address.address||null})}),[p]),(0,j.jsx)(T.Z,{visible:!!n,title:r("create.address"),onCancel:i,footer:[(0,j.jsx)(z.Z,{type:"primary",onClick:function(){return s.submit()},children:r("save")},"saveBtn"),(0,j.jsx)(z.Z,{type:"default",onClick:i,children:r("cancel")},"cancelBtn")],children:(0,j.jsxs)(G.Z,{layout:"vertical",name:"user-address",form:s,onFinish:function(e){var n=(0,b.Z)((0,b.Z)({},e),{},{active:1,lat:y.lat,lng:y.lng});d?d.setFieldsValue({address:{address:null===e||void 0===e?void 0:e.address},location:[y.lat,y.lng]}):c((0,O.Ng)({address:n,bag_id:p})),i()},children:[(0,j.jsx)(G.Z.Item,{name:"address",label:r("address"),rules:[{required:!0,message:r("required")}],children:(0,j.jsx)(ne.Z,{allowClear:!0,searchValue:N,showSearch:!0,autoClearSearchValue:!0,loading:S,options:null===C||void 0===C?void 0:C.map((function(e){return{label:e.description,value:e.description}})),onSearch:function(e){w(e),e.length>0&&I({input:e})},onSelect:function(){var e=(0,o.Z)(u().mark((function e(n){var i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ge.Z)(n);case 2:i=e.sent,g({lat:null===i||void 0===i?void 0:i.geometry.location.lat,lng:null===i||void 0===i?void 0:i.geometry.location.lng});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()})}),(0,j.jsx)(G.Z.Item,{label:r("map"),children:(0,j.jsx)(ye.Z,{location:y,setLocation:g,setAddress:function(e){return s.setFieldsValue({address:e})}})})]})})}var ke=i(66672);var Ne=function(e){var n=e.visible,i=e.handleCancel,d=(0,Z.$)().t,o=G.Z.useForm(),s=(0,a.Z)(o,1)[0],u=(0,l.useState)(!1),c=(0,a.Z)(u,2),v=c[0],p=c[1],m=(0,l.useState)(null),h=(0,a.Z)(m,2),f=(h[0],h[1]),y=(0,l.useState)(!1),g=(0,a.Z)(y,2),_=g[0],k=g[1],N=(0,x.v9)((function(e){return(0,A.TW)(e.cart)}));return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(T.Z,{visible:n,title:d("create.address"),onCancel:i,footer:[(0,j.jsx)(z.Z,{type:"primary",onClick:function(){return s.submit()},loading:_,children:d("save")},"saveBtn"),(0,j.jsx)(z.Z,{type:"default",onClick:i,children:d("cancel")},"cancelBtn")],children:(0,j.jsx)(G.Z,{layout:"vertical",form:s,onFinish:function(e){var n;k(!0);var l=(0,b.Z)({user_id:null===(n=N.user)||void 0===n?void 0:n.value,active:1},e);pe.create(l).then((function(){I.Am.success(d("successfully.added")),i()})).catch((function(e){return f(e.response.data.params)})).finally((function(){return k(!1)}))},children:(0,j.jsxs)(r.Z,{gutter:24,children:[(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{name:"firstname",label:d("firstname"),rules:[{required:!0,message:d("required")}],children:(0,j.jsx)(ke.Z,{})})}),(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{name:"lastname",label:d("lastname"),rules:[{required:!0,message:d("required")}],children:(0,j.jsx)(ke.Z,{})})}),(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{name:"title",label:d("title"),rules:[{required:!0,message:d("required")}],children:(0,j.jsx)(ke.Z,{})})}),(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{label:d("phone.number"),name:"phone",rules:[{validator:function(e,n){return n<0?Promise.reject(new Error(d("must.be.positive"))):Promise.resolve()}}],children:(0,j.jsx)(ee.Z,{className:"w-100",addonBefore:"+",parser:function(e){return parseInt(e,10)}})})}),(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{name:"street_house_number",label:d("home.number"),rules:[{required:!0,message:d("required")},{type:"number",max:99999999,message:d("max.length.8")}],children:(0,j.jsx)(ee.Z,{placeholder:d("home.number"),className:"w-100",min:0})})}),(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{name:"zipcode",label:d("zip.code"),rules:[{required:!0,message:d("required")}],children:(0,j.jsx)(ke.Z,{placeholder:d("zip.code"),className:"w-100",maxLength:15})})}),(0,j.jsxs)(t.Z,{span:24,children:[(0,j.jsx)(G.Z.Item,{name:["address","address"],label:d("address"),rules:[{required:!0,message:""}],onClick:function(){p(!0)},children:(0,j.jsx)(ke.Z,{autoComplete:"off",placeholder:d("address")})}),(0,j.jsx)(G.Z.Item,{name:["location",0],hidden:!0}),(0,j.jsx)(G.Z.Item,{name:["location",1],hidden:!0})]}),(0,j.jsx)(t.Z,{span:24,children:(0,j.jsx)(G.Z.Item,{name:"additional_details",label:d("details"),children:(0,j.jsx)(ke.Z,{})})})]})})}),v&&(0,j.jsx)(_e,{uuid:v,handleCancel:function(){return p(null)},parentForm:s})]})},we=function(e){var n,i,d,s,p,m=e.form,f=(0,Z.$)().t,y=(0,x.I0)(),g=(0,x.v9)((function(e){return(0,A.TW)(e.cart)})),_=(0,x.v9)((function(e){return e.myShop}),x.wU).myShop,k=(0,x.v9)((function(e){return e.cart}),x.wU).currentBag,N=null===_||void 0===_||null===(n=_.shop_closed_date)||void 0===n?void 0:n.map((function(e){return e.day})),w=(0,l.useState)(null),q=(0,a.Z)(w,2),C=q[0],S=q[1],F=(0,l.useState)(!1),Y=(0,a.Z)(F,2),M=Y[0],D=Y[1],T=(0,l.useState)({deliveryZone:!1,table:!1}),V=(0,a.Z)(T,2),U=V[0],P=V[1],E=(0,l.useRef)([]);(0,h.Z)((function(){null!==_&&void 0!==_&&_.id&&m.setFieldsValue({deliveryZone:null===g||void 0===g?void 0:g.deliveryZone,table:null===g||void 0===g?void 0:g.table})}),[k]);var H=[{label:f("dine.in"),value:"dine_in",key:2},{label:f("delivery"),value:"delivery",key:1},{label:f("pickup"),value:"pickup",key:0}],$=function(){var e=(0,o.Z)(u().mark((function e(n){var i,l,d,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.search,l=n.page,d=void 0===l?1:l,r={search:null!==i&&void 0!==i&&i.length?i:void 0,shop_id:null===_||void 0===_?void 0:_.id,page:d},e.next=4,xe.Z.getAll(r).then((function(e){var n;return P((function(n){var i;return(0,b.Z)((0,b.Z)({},n),{},{deliveryZone:!(null===e||void 0===e||null===(i=e.links)||void 0===i||!i.next)})})),null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){return(0,he.Z)(e)}))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),W=function(){var e=(0,o.Z)(u().mark((function e(n){var i,l,d,r,t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=n.search,d=n.page,r=void 0===d?1:d,t={search:null!==l&&void 0!==l&&l.length?l:void 0,shop_section_id:(null===g||void 0===g||null===(i=g.deliveryZone)||void 0===i?void 0:i.value)||void 0,shop_id:null===_||void 0===_?void 0:_.id,page:r},e.next=4,fe.Z.getAll(t).then((function(e){var n;return P((function(n){var i;return(0,b.Z)((0,b.Z)({},n),{},{table:!(null===e||void 0===e||null===(i=e.links)||void 0===i||!i.next)})})),null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){return{label:(null===e||void 0===e?void 0:e.name)||f("N/A"),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,j.jsxs)(c.Z,{className:k?"":"tab-card",children:[(0,j.jsxs)(r.Z,{gutter:12,children:[(0,j.jsx)(t.Z,{span:24,children:(0,j.jsx)(G.Z.Item,{name:"delivery",label:f("delivery"),rules:[{required:!0,message:f("required")}],children:(0,j.jsx)(ne.Z,{placeholder:f("delivery.type"),options:H,labelInValue:!0,onSelect:function(e){return y((0,O.Ng)({delivery_fee:e.value,bag_id:k}))},onChange:function(e){var n;return y((0,O.Ng)({deliveries:e,address:"",bag_id:k,paymentType:"dine_in"===(null===e||void 0===e?void 0:e.value)||"pickup"===(null===e||void 0===e?void 0:e.value)?"cash"===(null===g||void 0===g||null===(n=g.paymentType)||void 0===n?void 0:n.value)?null===g||void 0===g?void 0:g.paymentType:void 0:null===g||void 0===g?void 0:g.paymentType}))}})})}),"dine_in"===(null===g||void 0===g||null===(i=g.deliveries)||void 0===i?void 0:i.value)&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{name:"deliveryZone",label:f("delivery.zone"),rules:[{required:!0,message:f("required")}],children:(0,j.jsx)(me._,{className:"w-100",hasMore:null===U||void 0===U?void 0:U.deliveryZone,placeholder:f("select.delivery.zone"),fetchOptions:$,onChange:function(e){y((0,O.Ng)({bag_id:k,deliveryZone:e,table:null})),m.setFieldsValue({table:null})},value:null===g||void 0===g?void 0:g.deliveryZone,disabled:!(null!==_&&void 0!==_&&_.id)})})}),(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{name:"table",label:f("table"),rules:[{required:!0,message:f("required")}],children:(0,j.jsx)(me._,{className:"w-100",hasMore:null===U||void 0===U?void 0:U.table,placeholder:f("select.table"),fetchOptions:W,onChange:function(e){y((0,O.Ng)({bag_id:k,table:e}))},refetchOnFocus:!0,value:null===g||void 0===g?void 0:g.table,disabled:!(null!==g&&void 0!==g&&null!==(d=g.deliveryZone)&&void 0!==d&&d.value)})})})]}),1===(null===g||void 0===g||null===(s=g.deliveries)||void 0===s?void 0:s.key)&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(t.Z,{span:21,children:(0,j.jsx)(G.Z.Item,{name:"deliveryAddress",label:f("address"),rules:[{required:!0,message:f("address")}],children:(0,j.jsx)(v.h,{fetchOptions:function(e){var n={search:e,perPage:10,page:1};return pe.getAll(n).then((function(e){var n=e.data;return E.current=n,null===n||void 0===n?void 0:n.map((function(e){var n;return{label:(null===e||void 0===e?void 0:e.title)||(null===(n=e.address)||void 0===n?void 0:n.address),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},placeholder:f("select.address"),allowClear:!1,onChange:function(e){var n,i,l;if(void 0===e)return y((0,O.Ng)({bag_id:k,address:""}));var d=E.current.find((function(n){return n.id===e.value})),r={address:null===d||void 0===d||null===(n=d.address)||void 0===n?void 0:n.address,active:1,lat:null===d||void 0===d?void 0:d.location[0],lng:null===d||void 0===d?void 0:d.location[1]};y((0,O.Ng)({address:r,deliveryAddress:{value:(null===d||void 0===d?void 0:d.title)||(null===d||void 0===d||null===(i=d.address)||void 0===i?void 0:i.address),label:(null===d||void 0===d?void 0:d.title)||(null===d||void 0===d||null===(l=d.address)||void 0===l?void 0:l.address)},bag_id:k}))},autoComplete:"none"})})}),(0,j.jsx)(t.Z,{span:3,children:(0,j.jsx)(G.Z.Item,{label:" ",children:(0,j.jsx)(z.Z,{icon:(0,j.jsx)(B.Z,{}),onClick:function(){g.userUuid?D(!0):I.Am.warning(f("please.select.client"))}})})})]}),"delivery"===(null===g||void 0===g||null===(p=g.deliveries)||void 0===p?void 0:p.value)&&(0,j.jsx)(t.Z,{span:24,children:(0,j.jsxs)(r.Z,{gutter:12,children:[(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{name:"delivery_date",label:f("delivery.date"),rules:[{required:!0,message:f("required")}],children:(0,j.jsx)(ce.Z,{placeholder:f("delivery.date"),className:"w-100",format:"YYYY-MM-DD",allowClear:!1,disabledDate:function(e){var n=null===N||void 0===N?void 0:N.find((function(n){return n===ue()(e).format("YYYY-MM-DD")})),i=ue()().add(-1,"days")>=e;return n||i},onChange:function(e){var n=ue()(e).format("YYYY-MM-DD");y((0,O.Ng)({delivery_date:n,bag_id:k}))}})})}),(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{label:"".concat(f("delivery.time")," (").concat(f("up.to"),")"),name:"delivery_time",rules:[{required:!0,message:f("required")}],children:(0,j.jsx)(ce.Z,{disabled:!g.delivery_date,picker:"time",placeholder:f("start.time"),className:"w-100",format:"HH:mm:ss",showNow:!1,disabledTime:function(){return{disabledHours:function(){return function(e,n){for(var i=parseInt(e),l=parseInt(n),d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],r=i;r<=l;r++)delete d[r];return d}(ue()(null===g||void 0===g?void 0:g.delivery_date).format("YYYYMMDD")===ue()(new Date).format("YYYYMMDD")?ue()(new Date).add(1,"hour").format("HH"):0,24)},disabledMinutes:function(){return[]},disabledSeconds:function(){return[]}}},onChange:function(e){var n=ue()(e).format("HH:mm:ss");y((0,O.Ng)({delivery_time:n,bag_id:k}))},allowClear:!1})})})]})})]}),C&&(0,j.jsx)(_e,{uuid:C,handleCancel:function(){return S(null)}}),M&&(0,j.jsx)(Ne,{visible:M,handleCancel:function(){return D(!1)}})]})};function qe(e){var n=e.visible,i=e.handleCancel,d=(0,Z.$)().t,o=G.Z.useForm(),s=(0,a.Z)(o,1)[0],u=(0,l.useState)(!1),c=(0,a.Z)(u,2),v=c[0],p=c[1],m=(0,l.useState)(null),h=(0,a.Z)(m,2),x=h[0],f=h[1];return(0,j.jsx)(T.Z,{title:d("add.client"),visible:n,onCancel:i,footer:[(0,j.jsx)(z.Z,{type:"primary",onClick:function(){return s.submit()},loading:v,children:d("save")},"ok-button"),(0,j.jsx)(z.Z,{onClick:i,children:d("cancel")},"cancel-button")],children:(0,j.jsx)(G.Z,{layout:"vertical",name:"user-add-form",form:s,onFinish:function(e){var n=(0,b.Z)((0,b.Z)({},e),{},{role:"user"});p(!0),re.Z.create(n).then((function(){I.Am.success(d("successfully.added")),i()})).catch((function(e){return f(e.response.data.params)})).finally((function(){return p(!1)}))},children:(0,j.jsxs)(r.Z,{gutter:12,children:[(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{label:d("firstname"),name:"firstname",help:null!==x&&void 0!==x&&x.firstname?x.firstname[0]:null,validateStatus:null!==x&&void 0!==x&&x.firstname?"error":"success",rules:[{required:!0,message:d("required")}],children:(0,j.jsx)(ke.Z,{})})}),(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{label:d("lastname"),name:"lastname",help:null!==x&&void 0!==x&&x.lastname?x.lastname[0]:null,validateStatus:null!==x&&void 0!==x&&x.lastname?"error":"success",rules:[{required:!0,message:d("required")}],children:(0,j.jsx)(ke.Z,{})})}),(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{label:d("phone"),name:"phone",help:null!==x&&void 0!==x&&x.phone?x.phone[0]:null,validateStatus:null!==x&&void 0!==x&&x.phone?"error":"success",rules:[{required:!0,message:d("required")}],children:(0,j.jsx)(ee.Z,{min:0,className:"w-100"})})}),(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{label:d("email"),name:"email",help:null!==x&&void 0!==x&&x.email?x.email[0]:null,validateStatus:null!==x&&void 0!==x&&x.email?"error":"success",rules:[{required:!0,message:d("required")}],children:(0,j.jsx)(ke.Z,{type:"email"})})})]})})})}function Ce(){var e,n,i,d,s,p=(0,Z.$)().t,m=G.Z.useForm(),f=(0,a.Z)(m,1)[0],y=(0,x.I0)(),g=(0,x.v9)((function(e){return e.currency}),x.wU),b=g.currencies,k=g.loading,N=(0,x.v9)((function(e){return e.cart}),x.wU),q=N.currentBag,C=N.bags,I=N.currency,S=(0,M.TH)(),F=null===S||void 0===S||null===(e=S.state)||void 0===e?void 0:e.delivery_type,Y=(0,x.v9)((function(e){return e.globalSettings.settings}),x.wU).before_order_phone_required,D=(0,x.v9)((function(e){return(0,A.TW)(e.cart)})),T=(0,l.useState)([]),V=(0,a.Z)(T,2),U=V[0],B=V[1],E=(0,l.useState)(null),H=(0,a.Z)(E,2),$=H[0],W=H[1];function L(){return L=(0,o.Z)(u().mark((function e(n){var i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={search:n,perPage:10},e.abrupt("return",re.Z.getAll(i).then((function(e){var n=e.data;return B(n),J(n)})));case 2:case"end":return e.stop()}}),e)}))),L.apply(this,arguments)}function J(e){if(e)return(0,te.isArray)(e)?e.map((function(e){return{label:"".concat((null===e||void 0===e?void 0:e.firstname)||""," ").concat((null===e||void 0===e?void 0:e.lastname)||""),value:null===e||void 0===e?void 0:e.id}})):{label:"".concat((null===e||void 0===e?void 0:e.firstname)||""," ").concat((null===e||void 0===e?void 0:e.lastname)||""),value:null===e||void 0===e?void 0:e.id}}(0,h.Z)((function(){var e;"dine_in"===(null===D||void 0===D||null===(e=D.deliveries)||void 0===e?void 0:e.value)&&f.setFieldsValue({payment_type:null===D||void 0===D?void 0:D.paymentType})}),[null===D||void 0===D||null===(n=D.deliveries)||void 0===n?void 0:n.value,q]);function Q(){return(Q=(0,o.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ae.Z.getAll().then((function(e){return null===e||void 0===e?void 0:e.data.filter((function(e){var n,i;return"dine_in"===(null===D||void 0===D||null===(n=D.deliveries)||void 0===n?void 0:n.value)||"pickup"===(null===D||void 0===D||null===(i=D.deliveries)||void 0===i?void 0:i.value)?"cash"===e.tag:"cash"===e.tag||"wallet"===e.tag})).map((function(e){return{label:p(e.tag)||p("N/A"),value:null===e||void 0===e?void 0:e.tag,key:null===e||void 0===e?void 0:e.id}}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,l.useEffect)((function(){if(I){var e={label:"".concat(null===I||void 0===I?void 0:I.title," (").concat(null===I||void 0===I?void 0:I.symbol,")"),value:I.id};y((0,O.Ng)({formCurrency:e,bag_id:q})),f.setFieldsValue({currency:e})}else{var n=b.find((function(e){return e.default})),i={label:"".concat(null===n||void 0===n?void 0:n.title," (").concat(null===n||void 0===n?void 0:n.symbol,")"),value:n.id};y((0,O.Ng)({currentCurrency:n,bag_id:q})),y((0,O.NW)(n)),f.setFieldsValue({currency:i})}}),[]),(0,l.useEffect)((function(){f.setFieldsValue({user:D.user||null,payment_type:D.paymentType||null,address:D.address.address||null,deliveryAddress:D.deliveryAddress,delivery:D.deliveries||null,delivery_time:null!==D&&void 0!==D&&D.delivery_time?ue()("".concat(null===D||void 0===D?void 0:D.delivery_date," ").concat(null===D||void 0===D?void 0:D.delivery_time)):null,delivery_date:null!==D&&void 0!==D&&D.delivery_date?ue()(null===D||void 0===D?void 0:D.delivery_date):null,phone:(null===D||void 0===D?void 0:D.phone)||null})}),[q,D]),(0,j.jsxs)("div",{className:"order-tabs",children:[(0,j.jsxs)("div",{className:"tabs-container",children:[(0,j.jsx)("div",{className:"tabs",children:C.map((function(e){return(0,j.jsx)("div",{className:e===q?"tab active":"tab",onClick:function(){return y((0,O.$s)(e))},children:(0,j.jsxs)(P.Z,{children:[(0,j.jsx)(ie.Z,{}),(0,j.jsxs)("span",{children:[p("bag")," - ",e+1]}),!!e&&e===q&&(0,j.jsx)(le.Z,{onClick:function(n){return function(e,n){e.preventDefault(),e.stopPropagation(),y((0,O.KI)(n))}(n,e)},className:"close-button",size:12})]})},"tab"+e)}))}),(0,j.jsx)(z.Z,{size:"small",type:"primary",shape:"circle",icon:(0,j.jsx)(w.Z,{}),className:"tab-add-button",onClick:function(){return y((0,O.Cs)())}})]}),(0,j.jsxs)(G.Z,{layout:"vertical",name:"pos-form",form:f,children:[!F&&(0,j.jsx)(we,{form:f}),(0,j.jsxs)(c.Z,{children:[k&&(0,j.jsx)("div",{className:"loader",children:(0,j.jsx)(_.Z,{})}),(0,j.jsxs)(r.Z,{gutter:6,style:{marginBottom:15},children:["delivery"===(null===D||void 0===D||null===(i=D.deliveries)||void 0===i?void 0:i.value)&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(t.Z,{span:21,children:(0,j.jsx)(G.Z.Item,{name:"user",label:p("user"),rules:[{required:!0,message:""}],className:"w-100",children:(0,j.jsx)(v.h,{placeholder:p("select.client"),fetchOptions:function(e){return L.apply(this,arguments)},onSelect:function(e){var n=U.find((function(n){return(null===n||void 0===n?void 0:n.id)===(null===e||void 0===e?void 0:e.value)}));y((0,O.Ng)({user:e,userUuid:null===n||void 0===n?void 0:n.uuid,bag_id:q,phone:null===n||void 0===n?void 0:n.phone,userOBJ:n})),f.setFieldsValue({address:null,phone:null===n||void 0===n?void 0:n.phone})},onClear:function(){f.setFieldsValue({phone:null,user:null})}})})}),(0,j.jsx)(t.Z,{span:3,children:(0,j.jsx)(G.Z.Item,{label:" ",children:(0,j.jsx)(z.Z,{icon:(0,j.jsx)(de.Z,{}),onClick:function(){W(!0)}})})})]}),"delivery"===(null===D||void 0===D||null===(d=D.deliveries)||void 0===d?void 0:d.value)&&"1"===Y&&(0,j.jsx)(t.Z,{span:24,children:(0,j.jsx)(G.Z.Item,{name:"phone",rules:[{required:!0,message:p("required")},{validator:function(e,n){if(n<0)return Promise.reject(new Error(p("must.be.positive")))}}],children:(0,j.jsx)(ee.Z,{className:"w-100",placeholder:p("phone.number"),disabled:null===D||void 0===D||null===(s=D.userOBJ)||void 0===s?void 0:s.phone,onChange:function(e){return y((0,O.Ng)({phone:e,bag_id:q}))}})})}),(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{name:"currency",label:p("currency"),rules:[{required:!0,message:p("required")}],children:(0,j.jsx)(ne.Z,{placeholder:p("select.currency"),onSelect:function(e){var n=b.find((function(n){return n.id===e.value}));y((0,O.NW)(n))},labelInValue:!0,disabled:!0,children:null===b||void 0===b?void 0:b.map((function(e,n){return(0,j.jsx)(ne.Z.Option,{value:null===e||void 0===e?void 0:e.id,children:"".concat(null===e||void 0===e?void 0:e.title," (").concat(null===e||void 0===e?void 0:e.symbol,")")},n)}))})})}),(0,j.jsx)(t.Z,{span:12,children:(0,j.jsx)(G.Z.Item,{label:p("payment.type"),name:"payment_type",rules:[{required:!0,message:p("required")}],children:(0,j.jsx)(oe.q,{fetchOptions:function(){return Q.apply(this,arguments)},className:"w-100",placeholder:p("select.payment.type"),onSelect:function(e){y((0,O.Ng)({paymentType:e,bag_id:q}))},refetch:!0})})})]})]})]}),$&&(0,j.jsx)(qe,{visible:$,handleCancel:function(){return W(!1)}})]})}var Ie=i(47515),Se=i(43681),Ae=i(62412),Fe=i(21448),Ye=i(1003),Me=i(74776),De=i.n(Me),Te=i(92855),ze=i(78508),Ve=i(66204),Ue=i(2337),Pe=i(31774),Be=function(e){var n,i,d,r,t,o,s,u,v,p,m,h,x,f,y,g,k,N,w,q,C=e.orderId,I=e.handleClose,S=(0,Z.$)().t,A=(0,l.useState)(!1),F=(0,a.Z)(A,2),Y=F[0],M=F[1],D=(0,l.useState)(null),V=(0,a.Z)(D,2),U=V[0],B=V[1],E=(0,l.useState)([]),O=(0,a.Z)(E,2),$=O[0],W=O[1];return(0,l.useEffect)((function(){C&&(M(!0),Ae.Z.getById(C).then((function(e){B(e.data);var n=e.data.details.map((function(e){return(0,b.Z)((0,b.Z)((0,b.Z)({},e),e.stock.extras),{},{numberQuantity:e.quantity,numberTax:e.tax})}));W(n)})).finally((function(){return M(!1)})))}),[]),(0,j.jsx)(T.Z,{visible:!!C,title:"Order created successfully",onOk:I,onCancel:I,footer:[(0,j.jsx)(z.Z,{onClick:I,children:S("back")}),(0,j.jsxs)(z.Z,{type:"primary",onClick:function(){return window.print()},children:[(0,j.jsx)(Pe.Z,{type:"printer"}),(0,j.jsx)("span",{className:"ml-1",children:S("print")})]})],style:{minWidth:"80vw"},children:(0,j.jsx)("div",{className:"py-4",children:Y?(0,j.jsx)("div",{className:"w-100 text-center",children:(0,j.jsx)(_.Z,{})}):(0,j.jsxs)(c.Z,{title:"".concat(S("order.details")," ").concat(null!==U&&void 0!==U&&U.id?"#".concat(null===U||void 0===U?void 0:U.id):""),className:"order-details",children:[(0,j.jsxs)("div",{className:"d-flex justify-content-between mt-3",children:[(0,j.jsxs)("div",{children:[(0,j.jsxs)("h2",{className:"mb-1 font-weight-semibold",children:[S("invoice")," #",null===U||void 0===U?void 0:U.id]}),(0,j.jsx)("p",{children:ue()(null===U||void 0===U?void 0:U.created_at).format("YYYY-MM-DD")}),(0,j.jsx)("address",{children:(0,j.jsxs)("p",{children:[(0,j.jsxs)("span",{children:[S("delivery.type"),": ",null===U||void 0===U?void 0:U.delivery_type]}),(0,j.jsx)("br",{}),(0,j.jsxs)("span",{children:[S("otp"),": ",null!==(n=null===U||void 0===U?void 0:U.otp)&&void 0!==n?n:S("N/A")]}),!(null===U||void 0===U||!U.table)&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("br",{}),(0,j.jsxs)("span",{children:[S("table"),": ",(null===U||void 0===U||null===(i=U.table)||void 0===i?void 0:i.name)||S("N/A")]})]}),!(null===U||void 0===U||null===(d=U.address)||void 0===d||!d.address)&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("br",{}),(0,j.jsxs)("span",{children:[S("delivery.address"),": ",null===U||void 0===U||null===(r=U.address)||void 0===r?void 0:r.address]})]}),!(null===U||void 0===U||!U.delivery_date_time)&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("br",{}),(0,j.jsx)("span",{children:"".concat(S("delivery.date"),": ").concat(ue()(null===U||void 0===U?void 0:U.delivery_date_time).format("YYYY-MM-DD HH:mm"))})]}),(null===U||void 0===U?void 0:U.note)&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("br",{}),(0,j.jsxs)("span",{children:[S("note"),": ",null===U||void 0===U?void 0:U.note]})]})]})})]}),(0,j.jsx)("address",{children:(0,j.jsxs)("p",{children:[(0,j.jsxs)("span",{className:"font-weight-semibold text-dark font-size-md",children:[null===U||void 0===U||null===(t=U.user)||void 0===t?void 0:t.firstname," ",(null===U||void 0===U||null===(o=U.user)||void 0===o?void 0:o.lastname)||""]}),(null===U||void 0===U?void 0:U.phone)&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("br",{}),(0,j.jsxs)("span",{children:[S("phone"),": ",null===U||void 0===U?void 0:U.phone]})]}),(0,j.jsx)("br",{}),(0,j.jsxs)("span",{children:[S("email"),": ",null===U||void 0===U||null===(s=U.user)||void 0===s?void 0:s.email]})]})})]}),(0,j.jsxs)("div",{className:"mt-4",children:[(0,j.jsxs)(ze.Z,{scroll:{x:!0},dataSource:$,pagination:!1,className:"mb-5",children:[(0,j.jsx)(Ue.Z,{title:"No.",dataIndex:"id"},"id"),(0,j.jsx)(Ue.Z,{title:S("product"),dataIndex:"stock",render:function(e,n){var i,l,d,r;return(0,j.jsxs)(P.Z,{wrap:!0,children:[(0,j.jsx)("span",{children:null===e||void 0===e||null===(i=e.product)||void 0===i||null===(l=i.translation)||void 0===l?void 0:l.title}),(0,j.jsx)("span",{children:null===e||void 0===e||null===(d=e.extras)||void 0===d?void 0:d.map((function(e){return(0,j.jsx)(Ve.Z,{children:null===e||void 0===e?void 0:e.value},null===e||void 0===e?void 0:e.id)}))}),null===n||void 0===n||null===(r=n.addons)||void 0===r?void 0:r.map((function(e){var n,i,l;return(0,j.jsx)(Ve.Z,{children:"".concat(null===e||void 0===e||null===(n=e.stock)||void 0===n||null===(i=n.product)||void 0===i||null===(l=i.translation)||void 0===l?void 0:l.title," x ").concat((null===e||void 0===e?void 0:e.quantity)||1)},e.id)}))]})}},"stock"),(0,j.jsx)(Ue.Z,{title:S("quantity"),dataIndex:"numberQuantity",render:function(e,n){var i,l,d,r;return(0,j.jsx)("span",{children:"".concat(n.quantity," ").concat(null===n||void 0===n||null===(i=n.stock)||void 0===i||null===(l=i.product)||void 0===l||null===(d=l.unit)||void 0===d||null===(r=d.translation)||void 0===r?void 0:r.title)})}},"numberQuantity"),(0,j.jsx)(Ue.Z,{title:S("price"),dataIndex:"origin_price",render:function(e){var n,i;return(0,H.Z)(e,null===U||void 0===U||null===(n=U.currency)||void 0===n?void 0:n.symbol,null===U||void 0===U||null===(i=U.currency)||void 0===i?void 0:i.position)}},"origin_price"),(0,j.jsx)(Ue.Z,{title:S("tax"),dataIndex:"numberTax",render:function(e){var n,i;return(0,H.Z)(e,null===U||void 0===U||null===(n=U.currency)||void 0===n?void 0:n.symbol,null===U||void 0===U||null===(i=U.currency)||void 0===i?void 0:i.position)}},"numberTax"),(0,j.jsx)(Ue.Z,{title:S("total.price"),dataIndex:"total_price",render:function(e){var n,i;return(0,H.Z)(e,null===U||void 0===U||null===(n=U.currency)||void 0===n?void 0:n.symbol,null===U||void 0===U||null===(i=U.currency)||void 0===i?void 0:i.position)}},"total_price")]}),(0,j.jsx)("div",{className:"d-flex justify-content-end",children:(0,j.jsxs)("div",{className:"text-right ",children:[(0,j.jsxs)("div",{className:"border-bottom",children:[(0,j.jsx)("p",{className:"mb-2",children:"".concat(S("sub.total"),": ").concat((0,H.Z)(null===U||void 0===U?void 0:U.details.reduce((function(e,n){var i;return e+(null!==(i=n.total_price)&&void 0!==i?i:0)}),0),null===U||void 0===U||null===(u=U.currency)||void 0===u?void 0:u.symbol,null===U||void 0===U||null===(v=U.currency)||void 0===v?void 0:v.position))}),(0,j.jsx)("p",{children:"".concat(S("delivery.price"),": ").concat((0,H.Z)(null===U||void 0===U?void 0:U.delivery_fee,null===U||void 0===U||null===(p=U.currency)||void 0===p?void 0:p.symbol,null===U||void 0===U||null===(m=U.currency)||void 0===m?void 0:m.position))}),(0,j.jsx)("p",{children:"".concat(S("shop.tax"),": ").concat((0,H.Z)(null===U||void 0===U?void 0:U.tax,null===U||void 0===U||null===(h=U.currency)||void 0===h?void 0:h.symbol,null===U||void 0===U||null===(x=U.currency)||void 0===x?void 0:x.position))}),(0,j.jsx)("p",{children:"".concat(S("service.fee"),": ").concat((0,H.Z)(null===U||void 0===U?void 0:U.service_fee,null===U||void 0===U||null===(f=U.currency)||void 0===f?void 0:f.symbol,null===U||void 0===U||null===(y=U.currency)||void 0===y?void 0:y.position))}),!(null===U||void 0===U||!U.coupon)&&(0,j.jsx)("p",{children:"".concat(S("coupon"),": - ").concat((0,H.Z)(null===U||void 0===U||null===(g=U.coupon)||void 0===g?void 0:g.price,null===U||void 0===U||null===(k=U.currency)||void 0===k?void 0:k.symbol,null===U||void 0===U||null===(N=U.currency)||void 0===N?void 0:N.position))})]}),(0,j.jsxs)("h2",{className:"font-weight-semibold mt-3",children:[(0,j.jsxs)("span",{className:"mr-1",children:[S("grand.total"),": "]}),(0,H.Z)(null===U||void 0===U?void 0:U.total_price,null===U||void 0===U||null===(w=U.currency)||void 0===w?void 0:w.symbol,null===U||void 0===U||null===(q=U.currency)||void 0===q?void 0:q.position)]})]})})]})]})})})};function Ee(){var e,n,i,d=(0,Z.$)().t,o=(0,x.I0)(),s=(0,x.v9)((function(e){return e.cart}),x.wU),u=s.cartItems,v=s.cartShops,p=s.currentBag,m=s.total,f=s.coupons,y=s.currency,g=(0,x.v9)((function(e){return(0,A.fq)(e.cart)})),k=(0,x.v9)((function(e){return(0,A.TW)(e.cart)}),x.wU),N=(0,l.useState)(!1),S=(0,a.Z)(N,2),F=S[0],Y=S[1],D=(0,l.useState)(null),T=(0,a.Z)(D,2),V=T[0],U=T[1],B=(0,l.useState)(null),$=(0,a.Z)(B,2),W=$[0],L=$[1],J=G.Z.useForm(),Q=(0,a.Z)(J,1)[0],K=(0,x.v9)((function(e){return e.myShop}),x.wU).myShop,R=(0,M.TH)(),X=null===R||void 0===R||null===(e=R.state)||void 0===e?void 0:e.delivery_type,ee=(0,x.v9)((function(e){return e.menu}),x.wU).activeMenu,ne=function(e){var n;e.quantity!==(null===e||void 0===e||null===(n=e.stock)||void 0===n?void 0:n.quantity)&&e.quantity!==e.max_qty&&o((0,O.J$)((0,b.Z)((0,b.Z)({},e),{},{quantity:1})))},ie=function(e){1!==e.quantity&&(e.quantity<=e.min_qty||o((0,O.J$)((0,b.Z)((0,b.Z)({},e),{},{quantity:-1}))))};function le(){var e=function(e){var n,i,l,d,r,t={products:e.map((function(e){var n,i,l,d;return{quantity:e.quantity,stock_id:e.stockID?null===(n=e.stockID)||void 0===n?void 0:n.id:null===(i=e.stock)||void 0===i?void 0:i.id,addons:null!==e&&void 0!==e&&null!==(l=e.addons)&&void 0!==l&&l.length?null===e||void 0===e||null===(d=e.addons)||void 0===d?void 0:d.map((function(e){return{quantity:null===e||void 0===e?void 0:e.quantity,stock_id:null===e||void 0===e?void 0:e.stockID}})):void 0}})),currency_id:null===y||void 0===y?void 0:y.id,coupon:null!==f&&void 0!==f&&null!==(n=f[0])&&void 0!==n&&n.verified?null===f||void 0===f||null===(i=f[0])||void 0===i?void 0:i.coupon:void 0,shop_id:K.id,type:null===k||void 0===k||null===(l=k.deliveries)||void 0===l?void 0:l.value,address:{latitude:null===k||void 0===k||null===(d=k.address)||void 0===d?void 0:d.lat,longitude:null===k||void 0===k||null===(r=k.address)||void 0===r?void 0:r.lng}};return De().stringify(t,{addQueryPrefix:!0})}(g);Y(!0),Ae.Z.calculate(e).then((function(e){var n,i,l=e.data.data,d=l.stocks.map((function(e){return(0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)({},g.find((function(n){return n.id===e.id}))),e),e.stock.countable),{},{stock:e.stock.stock_extras,stocks:e.stock.stock_extras,stockID:e.stock})}));o((0,O.kT)(d));var r={product_total:null===(n=l.stocks)||void 0===n?void 0:n.reduce((function(e,n){return e+(n.total_price||n.price)}),0),shop_tax:null!==(i=null===l||void 0===l?void 0:l.total_shop_tax)&&void 0!==i?i:0,order_total:l.total_price,delivery_fee:l.delivery_fee,service_fee:null===l||void 0===l?void 0:l.service_fee,couponPrice:null===l||void 0===l?void 0:l.coupon_price};o((0,O.YP)(r))})).finally((function(){return Y(!1)}))}(0,h.Z)((function(){g.length&&le()}),[y]),(0,h.Z)((function(){g.length?le():o((0,O.ql)())}),[u,p,null===k||void 0===k?void 0:k.address,y,null===k||void 0===k?void 0:k.deliveries,f]);var de=function(){var e,n,i,l,r,t,o,a,s,u,c,p,h,x,Z,j,g,b,_,N,w,q,C;if(y||X){if("dine_in"===(null===k||void 0===k||null===(e=k.deliveries)||void 0===e?void 0:e.value)){var S,A;if(null===k||void 0===k||null===(S=k.deliveryZone)||void 0===S||!S.value)return void I.Am.warning(d("please.select.delivery.zone"));if(null===k||void 0===k||null===(A=k.table)||void 0===A||!A.value)return void I.Am.warning(d("please.select.table"))}if("delivery"!==(null===k||void 0===k||null===(n=k.deliveries)||void 0===n?void 0:n.value)||k.address||X)if("delivery"!==(null===k||void 0===k||null===(i=k.deliveries)||void 0===i?void 0:i.value)||null!==k&&void 0!==k&&k.delivery_time||X)if("delivery"!==(null===k||void 0===k||null===(l=k.deliveries)||void 0===l?void 0:l.value)||null!==k&&void 0!==k&&k.delivery_date||X){var F=null===v||void 0===v?void 0:v.flatMap((function(e){var n,i;return{stock_id:null===e||void 0===e||null===(n=e.stockID)||void 0===n?void 0:n.id,quantity:null===e||void 0===e?void 0:e.quantity,bonus:null!==e&&void 0!==e&&e.bonus?null===e||void 0===e?void 0:e.bonus:void 0,addons:null===e||void 0===e||null===(i=e.addons)||void 0===i?void 0:i.map((function(e){return{stock_id:null===e||void 0===e?void 0:e.id,quantity:null===e||void 0===e?void 0:e.quantity}}))}})),M={user_id:null===k||void 0===k||null===(r=k.user)||void 0===r?void 0:r.value,currency_id:null===y||void 0===y?void 0:y.id,rate:null===y||void 0===y?void 0:y.rate,shop_id:null===K||void 0===K?void 0:K.id,delivery_id:null===(t=k.deliveries)||void 0===t?void 0:t.value,coupon:(null===f||void 0===f||null===(o=f[0])||void 0===o?void 0:o.coupon)||void 0,tax:m.order_tax,payment_type:null===(a=k.paymentType)||void 0===a?void 0:a.value,delivery_date:null!==k&&void 0!==k&&k.delivery_date?null===k||void 0===k?void 0:k.delivery_date:void 0,delivery_address_id:null!==k&&void 0!==k&&null!==(s=k.address)&&void 0!==s&&s.address?null===k||void 0===k||null===(u=k.address)||void 0===u?void 0:u.address:void 0,address:null!==(c=k.address)&&void 0!==c&&c.address?{address:null===(p=k.address)||void 0===p?void 0:p.address,office:null,house:null,floor:null}:void 0,location:null!==k&&void 0!==k&&k.address?{latitude:null===(h=k.address)||void 0===h?void 0:h.lat,longitude:null===(x=k.address)||void 0===x?void 0:x.lng}:void 0,delivery_time:null!==k&&void 0!==k&&k.delivery_time?ue()(null===k||void 0===k?void 0:k.delivery_time,"HH:mm").format("HH:mm"):void 0,delivery_type:null===k||void 0===k||null===(Z=k.deliveries)||void 0===Z?void 0:Z.value,delivery_type_id:k.deliveries.key,phone:null!==k&&void 0!==k&&k.phone?null===k||void 0===k||null===(j=k.phone)||void 0===j?void 0:j.toString():void 0,table_id:(null===k||void 0===k||null===(g=k.table)||void 0===g?void 0:g.value)||void 0,products:F},D={currency_id:null===y||void 0===y?void 0:y.id,rate:null===y||void 0===y?void 0:y.rate,coupon:(null===f||void 0===f||null===(b=f[0])||void 0===b?void 0:b.coupon)||void 0,tax:m.order_tax,payment_type:null===k||void 0===k||null===(_=k.paymentType)||void 0===_?void 0:_.value,delivery_id:null===(N=k.deliveries)||void 0===N?void 0:N.value,delivery_type:null===k||void 0===k||null===(w=k.deliveries)||void 0===w?void 0:w.value,delivery_type_id:k.deliveries.key,shop_id:K.id,table_id:(null===k||void 0===k||null===(q=k.table)||void 0===q?void 0:q.value)||void 0,products:F},T="delivery"===(null===(C=k.deliveries)||void 0===C?void 0:C.value)?M:D,z={payment_sys_id:k.paymentType.key};Y(!0),Ae.Z.create(T).then((function(e){!function(e,n){Ye.Z.create(e,n).then((function(e){!function(e){U(e)}(e.data.id),Q.resetFields()})).finally((function(){return Y(!1)}))}(e.data.id,z)})).catch((function(e){return console.error(e)})).finally((function(){return Y(!1)}))}else I.Am.warning(d("please.select.delivery.date"));else I.Am.warning(d("shop.closed"));else I.Am.warning(d("please.select.address"))}else I.Am.warning(d("please.select.currency"))};return(0,j.jsxs)(c.Z,{children:[F&&(0,j.jsx)("div",{className:"loader",children:(0,j.jsx)(_.Z,{})}),(0,j.jsxs)("div",{className:"card-save",children:[v.map((function(e){var n,i,l,a,s,u,c,v,p,m,h,x;return(0,j.jsx)("div",{children:!0!==e.bonus?(0,j.jsx)("div",{className:"custom-cart-container",children:(0,j.jsxs)(r.Z,{className:"product-row",children:[(0,j.jsx)(Te.Z,{image:(0,q.Z)(null===e||void 0===e?void 0:e.img),row:e}),(0,j.jsx)(t.Z,{span:18,className:"product-col",children:(0,j.jsxs)("div",{children:[(0,j.jsx)("span",{className:"product-name",children:null===e||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title}),(0,j.jsx)("br",{}),(0,j.jsx)(P.Z,{wrap:!0,className:"mt-2",children:null===e||void 0===e||null===(i=e.stock)||void 0===i?void 0:i.map((function(e){return(0,j.jsx)("span",{className:"extras-text rounded pr-2 pl-2",children:e.value})}))}),(0,j.jsx)("br",{}),(0,j.jsx)(P.Z,{wrap:!0,className:"mt-2",children:null===(l=e.addons)||void 0===l?void 0:l.map((function(e){var n,i;return(0,j.jsxs)("span",{className:"extras-text rounded pr-2 pl-2",children:[null===e||void 0===e||null===(n=e.product)||void 0===n||null===(i=n.translation)||void 0===i?void 0:i.title," x"," ",e.quantity]})}))}),(0,j.jsxs)("div",{className:"product-counter",children:[(0,j.jsx)("span",{children:(0,H.Z)((null===e||void 0===e?void 0:e.total_price)||(null===e||void 0===e?void 0:e.price),null===y||void 0===y?void 0:y.symbol,null===y||void 0===y?void 0:y.position)}),(0,j.jsxs)("div",{className:"count",children:[(0,j.jsx)(z.Z,{className:"button-counter",shape:"circle",icon:(0,j.jsx)(E.Z,{size:14}),onClick:function(){return ie(e)}}),(0,j.jsxs)("span",{children:[e.countable_quantity*((null===e||void 0===e?void 0:e.interval)||1),null===e||void 0===e||null===(a=e.unit)||void 0===a||null===(s=a.translation)||void 0===s?void 0:s.title]}),(0,j.jsx)(z.Z,{className:"button-counter",shape:"circle",icon:(0,j.jsx)(w.Z,{size:14}),onClick:function(){return ne(e)}}),(0,j.jsx)(z.Z,{className:"button-counter",shape:"circle",onClick:function(){return n=e,o((0,O.h2)(n));var n},icon:(0,j.jsx)(Ie.Z,{size:14})})]})]})]})})]})},e.id):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("h4",{className:"mt-2",children:d("bonus.product")}),(0,j.jsx)("div",{className:"custom-cart-container",children:(0,j.jsxs)(r.Z,{className:"product-row",children:[(0,j.jsx)(Te.Z,{image:(0,q.Z)(null===e||void 0===e?void 0:e.img),row:e}),(0,j.jsx)(t.Z,{span:18,className:"product-col",children:(0,j.jsxs)("div",{children:[(0,j.jsx)("span",{className:"product-name",children:null===e||void 0===e||null===(u=e.stockID)||void 0===u||null===(c=u.product)||void 0===c||null===(v=c.translation)||void 0===v?void 0:v.title}),(0,j.jsx)("br",{}),(0,j.jsx)(P.Z,{wrap:!0,className:"mt-2",children:null===e||void 0===e||null===(p=e.stock)||void 0===p?void 0:p.map((function(e){return(0,j.jsx)("span",{className:"extras-text rounded pr-2 pl-2",children:null===e||void 0===e?void 0:e.value})}))}),(0,j.jsx)("br",{}),(0,j.jsx)(P.Z,{wrap:!0,className:"mt-2",children:null===(m=e.addons)||void 0===m?void 0:m.map((function(e){var n,i;return(0,j.jsxs)("span",{className:"extras-text rounded pr-2 pl-2",children:[null===e||void 0===e||null===(n=e.countable)||void 0===n||null===(i=n.translation)||void 0===i?void 0:i.title," x"," ",null===e||void 0===e?void 0:e.quantity]})}))}),(0,j.jsxs)("div",{className:"product-counter",children:[(0,j.jsx)("span",{children:(0,H.Z)((null===e||void 0===e?void 0:e.total_price)||(null===e||void 0===e?void 0:e.price),null===y||void 0===y?void 0:y.symbol,null===y||void 0===y?void 0:y.position)}),(0,j.jsxs)("div",{className:"count",children:[(0,j.jsx)(z.Z,{className:"button-counter",shape:"circle",icon:(0,j.jsx)(E.Z,{size:14}),onClick:function(){return ie(e)},disabled:!0}),(0,j.jsxs)("span",{children:[(null===e||void 0===e?void 0:e.quantity)*((null===e||void 0===e?void 0:e.interval)||1),null===e||void 0===e||null===(h=e.unit)||void 0===h||null===(x=h.translation)||void 0===x?void 0:x.title]}),(0,j.jsx)(z.Z,{className:"button-counter",shape:"circle",icon:(0,j.jsx)(w.Z,{size:14}),onClick:function(){return ne(e)},disabled:!0})]})]})]})})]})},e.id)]})})})),!(null===v||void 0===v||!v.length)&&(0,j.jsxs)("div",{className:"d-flex my-3",children:[(0,j.jsx)(ke.Z,{placeholder:d("coupon"),className:"w-100 mr-2",addonAfter:null!==(n=f.find((function(e){return e.shop_id===v[0].shop_id})))&&void 0!==n&&n.verified?(0,j.jsx)(Se.Z,{style:{color:"#18a695"}}):null,defaultValue:null===(i=f.find((function(e){return e.shop_id===v[0].shop_id})))||void 0===i?void 0:i.coupon,onBlur:function(e){var n;return o((0,O.gU)({coupon:e.target.value,user_id:null===(n=k.user)||void 0===n?void 0:n.value,shop_id:v[0].shop_id,verified:!1}))}}),(0,j.jsx)(z.Z,{onClick:function(){return function(e){var n=f.find((function(n){return n.shop_id===e}));n&&(L(e),Fe.Z.checkCoupon(n).then((function(n){return o((0,O.nC)({shop_id:e,price:n.data.price,verified:!0}))})).catch((function(){return o((0,O.nC)({shop_id:e,price:0,verified:!1}))})).finally((function(){return L(null)})))}(v[0].shop_id)},loading:W===v[0].shop_id,children:d("check.coupon")})]}),(0,j.jsx)(r.Z,{className:"all-price-row",children:(0,j.jsxs)(t.Z,{span:24,className:"col",children:[(0,j.jsxs)("div",{className:"all-price-container",children:[(0,j.jsx)("span",{children:d("sub.total")}),(0,j.jsx)("span",{children:(0,H.Z)(m.product_total,null===y||void 0===y?void 0:y.symbol,null===y||void 0===y?void 0:y.position)})]}),(0,j.jsxs)("div",{className:"all-price-container",children:[(0,j.jsx)("span",{children:d("coupon")}),(0,j.jsx)("span",{children:(0,H.Z)(null===m||void 0===m?void 0:m.couponPrice,null===y||void 0===y?void 0:y.symbol,null===y||void 0===y?void 0:y.position)})]}),(0,j.jsxs)("div",{className:"all-price-container",children:[(0,j.jsx)("span",{children:d("shop.tax")}),(0,j.jsx)("span",{children:(0,H.Z)(m.shop_tax,null===y||void 0===y?void 0:y.symbol,null===y||void 0===y?void 0:y.position)})]}),(0,j.jsxs)("div",{className:"all-price-container",children:[(0,j.jsx)("span",{children:d("delivery.fee")}),(0,j.jsx)("span",{children:(0,H.Z)(m.delivery_fee,null===y||void 0===y?void 0:y.symbol,null===y||void 0===y?void 0:y.position)})]}),(0,j.jsxs)("div",{className:"all-price-container",children:[(0,j.jsx)("span",{children:d("service.fee")}),(0,j.jsx)("span",{children:(0,H.Z)(m.service_fee,null===y||void 0===y?void 0:y.symbol,null===y||void 0===y?void 0:y.position)})]})]})}),(0,j.jsxs)(r.Z,{className:"submit-row",children:[(0,j.jsxs)(t.Z,{span:14,className:"col",children:[(0,j.jsx)("span",{children:d("total.amount")}),(0,j.jsx)("span",{children:(0,H.Z)(m.order_total,null===y||void 0===y?void 0:y.symbol,null===y||void 0===y?void 0:y.position)})]}),(0,j.jsx)(t.Z,{className:"col2",children:(0,j.jsx)(z.Z,{type:"primary",onClick:function(){return de()},disabled:!v.length,children:d("place.order")})})]})]}),!!V&&(0,j.jsx)(Be,{orderId:V,handleClose:function(){U(null),(0,x.dC)((function(){o((0,O.LL)()),o((0,O.Nk)()),o((0,C.xo)(ee))})),0!==p&&o((0,O.KI)(p)),I.Am.success(d("successfully.closed"))}})]})}function He(){return(0,j.jsx)("div",{className:"pos-system",children:(0,j.jsx)(d.Z,{className:"site-layout",children:(0,j.jsxs)(r.Z,{gutter:24,children:[(0,j.jsxs)(t.Z,{span:15,children:[(0,j.jsx)(g,{}),(0,j.jsx)(X,{})]}),(0,j.jsxs)(t.Z,{span:9,children:[(0,j.jsx)(Ce,{}),(0,j.jsx)(Ee,{})]})]})})})}}}]);