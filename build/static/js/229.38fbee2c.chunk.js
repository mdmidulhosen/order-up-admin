"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[229],{89281:function(e,n,t){t.d(n,{h:function(){return f}});var r=t(1413),a=t(29439),s=t(45987),i=t(47313),u=t(12279),l=t.n(u),d=t(74294),c=t(72652),o=t(46417),m=["fetchOptions","debounceTimeout","onClear"],f=function(e){var n=e.fetchOptions,t=e.debounceTimeout,u=void 0===t?400:t,f=e.onClear,h=(0,s.Z)(e,m),p=(0,i.useState)(!1),Z=(0,a.Z)(p,2),v=Z[0],x=Z[1],j=(0,i.useState)([]),b=(0,a.Z)(j,2),g=b[0],Y=b[1],y=(0,i.useMemo)((function(){return l()((function(e){Y([]),x(!0),n(e).then((function(e){Y(e),x(!1)}))}),u)}),[n,u]);return(0,o.jsx)(d.Z,(0,r.Z)((0,r.Z)({showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:y,onClear:function(){y(""),f&&f()},notFoundContent:v?(0,o.jsx)(c.Z,{size:"small"}):"no results"},h),{},{options:g,onFocus:function(){y("")}}))}},229:function(e,n,t){t.r(n),t.d(n,{default:function(){return j}});var r=t(1413),a=t(29439),s=t(47313),i=t(97890),u=t(23560),l=t(10976),d=t(77181),c=t(70816),o=t.n(c),m=t(2717),f=t(90954),h=t(57409),p=t(69660),Z=t(24511),v=t(4191),x=t(46417);function j(){var e=(0,Z.$)().t,n=(0,m.v9)((function(e){return e.menu}),m.wU).activeMenu,t=(0,m.I0)(),c=l.Z.useForm(),j=(0,a.Z)(c,1)[0],b=(0,i.s0)();(0,s.useEffect)((function(){return function(){var e=j.getFieldsValue(!0),a=JSON.stringify(e.start),s=JSON.stringify(e.end),i=(0,r.Z)((0,r.Z)({},e),{},{start:a,end:s});t((0,f.nc)({activeMenu:n,data:i}))}}),[]);return(0,x.jsx)(d.Z,{title:e("add.discount"),className:"h-100",children:(0,x.jsx)(v.Z,{form:j,handleSubmit:function(a,s){var i;if(o()(a.start).format("YYYY-MM-DD")>o()(a.end).format("YYYY-MM-DD"))return u.Am.error(e("start.date.must.be.before.end.date"));var l={price:a.price,type:a.type,products:a.products.map((function(e){return e.value})),start:a.start?o()(a.start).format("YYYY-MM-DD"):void 0,end:a.end?o()(a.end).format("YYYY-MM-DD"):void 0,images:[null===(i=s[0])||void 0===i?void 0:i.name]},d="seller/discounts";return h.Z.create(l).then((function(){u.Am.success(e("successfully.created")),t((function(){t((0,f.ph)((0,r.Z)((0,r.Z)({},n),{},{nextUrl:d}))),t((0,p.k)({}))})),b("/".concat(d))}))}})})}},4191:function(e,n,t){t.d(n,{Z:function(){return M}});var r=t(1413),a=t(15861),s=t(29439),i=t(87757),u=t.n(i),l=t(47313),d=t(10976),c=t(68197),o=t(59624),m=t(74294),f=t(16124),h=t(99096),p=t(59491),Z=t(70816),v=t.n(Z),x=t(89281),j=t(5764),b=t(24511),g=t(2717),Y=t(18333),y=t(46417);function M(e){var n,t,i=e.form,Z=e.handleSubmit,M=(0,b.$)().t,D=(0,g.v9)((function(e){return e.menu}),g.wU).activeMenu,w=(0,g.v9)((function(e){return e.myShop}),g.wU).myShop,q=(0,l.useState)(!1),S=(0,s.Z)(q,2),I=S[0],N=S[1],O=(0,l.useState)(null!==(n=D.data)&&void 0!==n&&n.image?null===(t=D.data)||void 0===t?void 0:t.image:[]),C=(0,s.Z)(O,2),k=C[0],F=C[1];function U(){return(U=(0,a.Z)(u().mark((function e(n){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={search:n,shop_id:w.id,status:"published",active:1,rest:1},e.abrupt("return",Y.Z.getAll(t).then((function(e){return e.data.map((function(e){var n;return{label:null===(n=e.translation)||void 0===n?void 0:n.title,value:e.id}}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,y.jsxs)(d.Z,{name:"discount-form",layout:"vertical",onFinish:function(e){N(!0),Z(e,k).finally((function(){return N(!1)}))},form:i,initialValues:(0,r.Z)({},function(){var e,n=D.data;if(null===(e=D.data)||void 0===e||!e.start)return n;var t=D.data.start,a=D.data.end;return(0,r.Z)((0,r.Z)({},n),{},{start:v()(t,"YYYY-MM-DD"),end:v()(a,"YYYY-MM-DD")})}()),className:"d-flex flex-column h-100",children:[(0,y.jsxs)(c.Z,{gutter:12,children:[(0,y.jsx)(o.Z,{span:12,children:(0,y.jsx)(d.Z.Item,{label:M("type"),name:"type",rules:[{required:!0,message:M("required")}],children:(0,y.jsxs)(m.Z,{children:[(0,y.jsx)(m.Z.Option,{value:"fix",children:M("fix")}),(0,y.jsx)(m.Z.Option,{value:"percent",children:M("percent")})]})})}),(0,y.jsx)(o.Z,{span:12,children:(0,y.jsx)(d.Z.Item,{label:M("price"),name:"price",rules:[{required:!0,message:M("required")}],children:(0,y.jsx)(f.Z,{min:0,className:"w-100"})})}),(0,y.jsx)(o.Z,{span:12,children:(0,y.jsx)(d.Z.Item,{label:M("start.date"),name:"start",rules:[{required:!0,message:M("required")}],children:(0,y.jsx)(h.Z,{className:"w-100",placeholder:"",disabledDate:function(e){return v()().add(-1,"days")>=e}})})}),(0,y.jsx)(o.Z,{span:12,children:(0,y.jsx)(d.Z.Item,{label:M("end.date"),name:"end",rules:[{required:!0,message:M("required")}],children:(0,y.jsx)(h.Z,{className:"w-100",placeholder:"",disabledDate:function(e){return v()().add(-1,"days")>=e}})})}),(0,y.jsx)(o.Z,{span:24,children:(0,y.jsx)(d.Z.Item,{label:M("products"),name:"products",rules:[{required:!0,message:M("required")}],children:(0,y.jsx)(x.h,{fetchOptions:function(e){return U.apply(this,arguments)},mode:"multiple"})})}),(0,y.jsx)(o.Z,{span:24,children:(0,y.jsx)(d.Z.Item,{label:M("image"),name:"images",rules:[{required:!k.length,message:M("required")}],children:(0,y.jsx)(j.Z,{type:"discounts",imageList:k,setImageList:F,form:i,multiple:!1,name:"image"})})})]}),(0,y.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,y.jsx)("div",{className:"pb-5",children:(0,y.jsx)(p.Z,{type:"primary",htmlType:"submit",loading:I,children:M("submit")})})})]})}}}]);