"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[5918],{49655:function(n,e,t){t.d(e,{_:function(){return Z}});var u=t(1413),i=t(93433),o=t(15861),l=t(29439),a=t(45987),r=t(87757),s=t.n(r),c=t(47313),d=t(12279),v=t.n(d),f=t(74294),h=t(72652),m=t(46417),p=["fetchOptions","debounceTimeout","hasMore","refetchOnFocus"],Z=function(n){var e=n.fetchOptions,t=n.debounceTimeout,r=void 0===t?400:t,d=n.hasMore,Z=n.refetchOnFocus,x=void 0!==Z&&Z,b=(0,a.Z)(n,p),_=(0,c.useState)(!1),j=(0,l.Z)(_,2),g=j[0],S=j[1],y=(0,c.useState)([]),k=(0,l.Z)(y,2),w=k[0],q=k[1],M=(0,c.useState)(!1),O=(0,l.Z)(M,2),N=O[0],F=O[1],I=(0,c.useState)(null),Y=(0,l.Z)(I,2),C=Y[0],D=Y[1],U=(0,c.useState)(1),H=(0,l.Z)(U,2),T=H[0],V=H[1],J=(0,c.useMemo)((function(){return v()((function(n){q([]),D(n),S(!0),e({search:n}).then((function(n){q(n),V(2),S(!1)})).finally((function(){return F(!1)}))}),r)}),[e,r,T]),z=function(){var n=(0,o.Z)(s().mark((function n(t){var u;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:u=t.target,N||u.scrollTop+u.offsetHeight!==u.scrollHeight||d&&(F(!0),e({search:C,page:T}).then((function(n){V((function(n){return n+1})),q([].concat((0,i.Z)(w),(0,i.Z)(n)))})).finally((function(){return F(!1)})));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,m.jsxs)(f.Z,(0,u.Z)((0,u.Z)({showSearch:!0,allowClear:!0,onPopupScroll:z,labelInValue:!0,filterOption:!1,onSearch:J,notFoundContent:g?(0,m.jsx)(h.Z,{size:"small"}):"no results",onFocus:function(){x?J(""):null!==w&&void 0!==w&&w.length||J("")}},b),{},{children:[w.map((function(n,e){return(0,m.jsx)(f.Z.Option,{value:n.value,children:n.label},e)})),N&&(0,m.jsx)(f.Z.Option,{children:(0,m.jsx)(h.Z,{size:"small"})})]}))}},95918:function(n,e,t){t.r(e);var u=t(1413),i=t(29439),o=t(47313),l=t(97890),a=t(23560),r=t(10976),s=t(77181),c=t(2717),d=t(90954),v=t(24511),f=t(70816),h=t.n(f),m=t(13783),p=t(73346),Z=t(51282),x=t(9215),b=t(46417);e.default=function(){var n=(0,v.$)().t,e=(0,c.v9)((function(n){return n.menu}),c.wU).activeMenu,t=(0,c.I0)(),f=r.Z.useForm(),_=(0,i.Z)(f,1)[0],j=(0,l.s0)(),g=(0,o.useState)(!1),S=(0,i.Z)(g,2),y=S[0],k=S[1],w=(0,c.v9)((function(n){return n.myShop}),c.wU).myShop,q=(0,l.UO)().id;(0,o.useEffect)((function(){return function(){var n=_.getFieldsValue(!0);n.expired_at=JSON.stringify(null===n||void 0===n?void 0:n.expired_at),t((0,d.nc)({activeMenu:e,data:n}))}}),[]);var M=function(n){k(!0),p.Z.getById(n).then((function(n){!function(n){var i,o,l,a,r,s,c,v,f,m=(0,u.Z)((0,u.Z)({},n),{},{expired_at:h()(n.expired_at,"YYYY-MM-DD"),bonus_stock_id:{label:"".concat(null===n||void 0===n||null===(i=n.bonusStock)||void 0===i||null===(o=i.product)||void 0===o||null===(l=o.translation)||void 0===l?void 0:l.title," ").concat(null!==n&&void 0!==n&&null!==(a=n.bonusStock)&&void 0!==a&&null!==(r=a.extras)&&void 0!==r&&r.length?"=> ".concat(null===n||void 0===n||null===(s=n.bonusStock)||void 0===s||null===(c=s.extras.map((function(n){var e,t;return"".concat(null===n||void 0===n||null===(e=n.group)||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title,": ").concat(null===n||void 0===n?void 0:n.value)})))||void 0===c?void 0:c.join(", ")):""),value:null===n||void 0===n||null===(v=n.bonusStock)||void 0===v?void 0:v.id,key:null===n||void 0===n||null===(f=n.bonusStock)||void 0===f?void 0:f.id}});_.setFieldsValue((0,u.Z)({},m)),t((0,d.nc)({activeMenu:e,data:(0,u.Z)((0,u.Z)({},m),{},{expired_at:JSON.stringify(m.expired_at)})})),k(!1)}(n.data)})).finally((function(){return t((0,d.A_)(e))}))};(0,o.useEffect)((function(){e.refetch&&M(q)}),[e.refetch]);return(0,b.jsx)(s.Z,{title:n("edit.bonus"),className:"h-100",children:y?(0,b.jsx)(Z.Z,{}):(0,b.jsx)(x.Z,{form:_,handleSubmit:function(i){var o={expired_at:h()(i.expired_at).format("YYYY-MM-DD"),status:i.status,type:"sum",value:i.value,bonus_stock_id:i.bonus_stock_id.value,bonus_quantity:i.bonus_quantity,bonusable_id:w.id},l="seller/bonus/shop";return p.Z.update(q,o).then((function(){a.Am.success(n("successfully.created")),(0,c.dC)((function(){t((0,d.ph)((0,u.Z)((0,u.Z)({},e),{},{nextUrl:l}))),t((0,m.Q)({}))})),j("/".concat(l))}))}})})}},9215:function(n,e,t){t.d(e,{Z:function(){return _}});var u=t(1413),i=t(29439),o=t(47313),l=t(10976),a=t(68197),r=t(59624),s=t(16124),c=t(99096),d=t(86345),v=t(59491),f=t(70816),h=t.n(f),m=t(24511),p=t(2717),Z=t(18333),x=t(49655),b=t(46417);function _(n){var e=n.form,t=n.handleSubmit,f=(0,m.$)().t,_=(0,p.v9)((function(n){return n.menu}),p.wU).activeMenu,j=(0,o.useState)({bonusStock:!1}),g=(0,i.Z)(j,2),S=g[0],y=g[1],k=(0,o.useState)(!1),w=(0,i.Z)(k,2),q=w[0],M=w[1];return(0,b.jsxs)(l.Z,{name:"bonus-form",layout:"vertical",onFinish:function(n){M(!0),t(n).finally((function(){return M(!1)}))},form:e,initialValues:(0,u.Z)((0,u.Z)({status:!0},_.data),function(){var n,e;if(null===(n=_.data)||void 0===n||!n.expired_at)return{};var t=JSON.parse(null===(e=_.data)||void 0===e?void 0:e.expired_at);return{expired_at:h()(t,"HH:mm:ss")}}()),className:"d-flex flex-column h-100",children:[(0,b.jsxs)(a.Z,{gutter:12,children:[(0,b.jsx)(r.Z,{span:12,children:(0,b.jsx)(l.Z.Item,{label:f("order_amount"),name:"value",rules:[{required:!0,message:f("required")},{type:"number",min:1,message:f("min.1")}],children:(0,b.jsx)(s.Z,{className:"w-100"})})}),(0,b.jsx)(r.Z,{span:12,children:(0,b.jsx)(l.Z.Item,{label:f("bonus.product.stock"),name:"bonus_stock_id",rules:[{required:!0,message:f("required")}],children:(0,b.jsx)(x._,{fetchOptions:function(n){var e=n.page,t=n.search,i={active:1,status:"published",page:e,search:null!==t&&void 0!==t&&t.length?t:void 0};return Z.Z.getStock(i).then((function(n){var e,t;return y((0,u.Z)((0,u.Z)({},S),{},{bonusStock:(null===n||void 0===n||null===(e=n.meta)||void 0===e?void 0:e.current_page)<=(null===n||void 0===n||null===(t=n.meta)||void 0===t?void 0:t.last_page)})),n.data.map((function(n){var e,t,u,i,o;return{label:"".concat(null===n||void 0===n||null===(e=n.product)||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title," ").concat(null!==n&&void 0!==n&&null!==(u=n.extras)&&void 0!==u&&u.length?" => ".concat(null===n||void 0===n||null===(i=n.extras)||void 0===i||null===(o=i.map((function(n){var e,t;return"".concat(null===n||void 0===n||null===(e=n.group)||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title,": ").concat(null===n||void 0===n?void 0:n.value)})))||void 0===o?void 0:o.join(", ")):""),value:null===n||void 0===n?void 0:n.id,key:null===n||void 0===n?void 0:n.id}}))}))},hasMore:null===S||void 0===S?void 0:S.bonusStock,allowClear:!1})})}),(0,b.jsx)(r.Z,{span:12,children:(0,b.jsx)(l.Z.Item,{label:f("bonus.product.quantity"),name:"bonus_quantity",rules:[{required:!0,message:f("required")},{type:"number",min:1,message:f("min.1")}],children:(0,b.jsx)(s.Z,{className:"w-100"})})}),(0,b.jsx)(r.Z,{span:12,children:(0,b.jsx)(l.Z.Item,{name:"expired_at",label:f("expired.at"),rules:[{required:!0,message:f("required")}],children:(0,b.jsx)(c.Z,{className:"w-100",placeholder:"",disabledDate:function(n){return h()().add(-1,"days")>=n}})})}),(0,b.jsx)(r.Z,{span:12,children:(0,b.jsx)(l.Z.Item,{label:f("active"),name:"status",valuePropName:"checked",children:(0,b.jsx)(d.Z,{})})})]}),(0,b.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,b.jsx)("div",{className:"pb-5",children:(0,b.jsx)(v.Z,{type:"primary",htmlType:"submit",loading:q,children:f("submit")})})})]})}}}]);