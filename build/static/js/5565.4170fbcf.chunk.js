"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[5565],{75565:function(e,t,n){n.r(t),n.d(t,{default:function(){return N}});var i=n(29439),a=n(47313),l=n(73591),r=n(97890),o=n(24511),d=n(59308),s=n(1413),u=n(45705),c=n(26824),v=n(66204),h=n(59491),m=n(77181),f=n(78508),x=n(45464),p=n(12019),Z=n(90954),g=n(2717),j=n(23560),y=n(69658),w=n(74580),b=n(53233),_=n(13945),k=n(80314),C=n(71810),I=n(4901),q=n(14349),P=n(70816),S=n.n(P),T=n(10976),M=n(9274),U=n(68197),A=n(59624),E=n(66672),F=n(46417);function Y(e){var t=e.data,n=e.handleCancel,l=e.handleOk,r=e.visible,d=(0,o.$)().t,u=T.Z.useForm(),c=(0,i.Z)(u,1)[0],v=(0,a.useState)(!1),m=(0,i.Z)(v,2),f=m[0],x=m[1];return(0,F.jsx)(M.Z,{title:d(t.title),visible:r,onCancel:n,footer:[(0,F.jsx)(h.Z,{type:"primary",onClick:function(){return c.submit()},loading:f,children:d("save")}),(0,F.jsx)(h.Z,{type:"default",onClick:n,children:d("cancel")})],children:(0,F.jsx)(T.Z,{layout:"vertical",onFinish:function(e){x(!0);var t=(0,s.Z)((0,s.Z)({},e),{},{status:"canceled"});l(t)},form:c,children:(0,F.jsx)(T.Z.Item,{children:(0,F.jsx)(U.Z,{className:"mt-4",children:(0,F.jsx)(A.Z,{span:24,children:(0,F.jsx)(T.Z.Item,{name:"status_note",label:d("note"),rules:[{validator:function(e,t){return t?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(d("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(d("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(d("required")))}}],children:(0,F.jsx)(E.Z.TextArea,{maxLength:250,showCount:!0})})})})})})})}var H={type:"category"};function K(e){var t,n,l,d=e.parentId,P=(e.type,e.activeTab),T=void 0===P?"request":P,M=(0,o.$)().t,U=(0,a.useContext)(w._).setIsModalVisible,A=(0,a.useState)(!1),E=(0,i.Z)(A,2),K=E[0],N=E[1],O=(0,a.useState)(!1),$=(0,i.Z)(O,2),z=$[0],B=$[1],D=(0,a.useState)(null),L=(0,i.Z)(D,2),W=L[0],R=L[1],V=(0,g.I0)(),G=(0,r.s0)(),J=(0,g.v9)((function(e){return e.menu}),g.wU).activeMenu,Q=(0,g.v9)((function(e){return e.requestModels}),g.wU),X=Q.data,ee=Q.meta,te=Q.loading,ne=Q.params,ie=J.data,ae=(0,r.UO)().uuid,le={sort:null===ie||void 0===ie?void 0:ie.sort,column:null===ie||void 0===ie?void 0:ie.column,perPage:null===ie||void 0===ie?void 0:ie.perPage,page:null===ie||void 0===ie?void 0:ie.page,parent_id:d},re=(0,a.useState)([{title:M("created.by"),dataIndex:"createdBy",key:"createdBy",is_show:!0,render:function(e){return(0,F.jsxs)("span",{children:[e.firstname," ",null===e||void 0===e?void 0:e.lastname," ",(0,F.jsx)("a",{href:"tel:".concat(null===e||void 0===e?void 0:e.phone),children:null===e||void 0===e?void 0:e.phone})]})}},{title:M("created.at"),dataIndex:"created_at",key:"created_at",is_show:!0,render:function(e){return S()(e).format("YYYY-MM-DD HH:mm")}},{title:M("name"),dataIndex:"name",key:"name",is_show:!0,render:function(e,t){var n,i,a,l,r,o;return(0,F.jsxs)(u.Z,{children:[null===t||void 0===t||null===(n=t.model)||void 0===n||null===(i=n.translation)||void 0===i?void 0:i.title," ",(0,F.jsx)(I.WFu,{})," ",null===t||void 0===t||null===(a=t.data)||void 0===a||null===(l=a.title)||void 0===l?void 0:l[null===t||void 0===t||null===(r=t.model)||void 0===r||null===(o=r.translation)||void 0===o?void 0:o.locale]]})}},{title:M("image"),dataIndex:"img",key:"img",is_show:!0,render:function(e,t){var n,i,a;return(0,F.jsxs)(u.Z,{children:[(0,F.jsx)(c.Z,{src:(0,x.Z)(null===t||void 0===t||null===(n=t.model)||void 0===n?void 0:n.img),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0}),(0,F.jsx)(I.WFu,{}),(0,F.jsx)(c.Z,{src:(0,x.Z)(null===t||void 0===t||null===(i=t.data)||void 0===i||null===(a=i.images)||void 0===a?void 0:a.at(0)),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0})]})}},{title:M("status"),is_show:!0,dataIndex:"status",key:"status",render:function(e,t){return(0,F.jsx)("div",{children:"pending"===e?(0,F.jsx)(v.Z,{color:"blue",children:M(e)}):"canceled"===e?(0,F.jsx)(v.Z,{color:"error",children:M(e)}):(0,F.jsx)(v.Z,{color:"cyan",children:M(e)})})}},{title:M("options"),key:"options",dataIndex:"options",is_show:!0,render:function(e,t){return(0,F.jsxs)(u.Z,{children:[(0,F.jsx)(h.Z,{icon:(0,F.jsx)(p.Z,{}),onClick:function(){return function(e){V((0,Z.bL)({url:"category-request/".concat(e.id),id:"request_edit",name:M("request.edit")})),G("/category-request/".concat(e.id),{state:{parentId:d,parentUuid:ae}})}(t)}}),(0,F.jsx)(h.Z,{type:"primary",onClick:function(){R([{id:t.id,status:"approved"}]),U(!0)},children:M("accept")}),(0,F.jsx)(h.Z,{type:"primary",danger:!0,onClick:function(){R([{id:t.id,status:"canceled"}]),N(!0)},children:M("decline")})]})}}]),oe=(0,i.Z)(re,2),de=oe[0],se=oe[1];(0,a.useEffect)((function(){J.refetch&&"request"===T&&(V((0,C.aw)(le)),V((0,Z.A_)(J)))}),[J.refetch]),(0,k.Z)((function(){"request"===T&&V((0,C.aw)(le))}),[T,J.data]);var ue=function(e){B(!0);var t={status:null===W||void 0===W?void 0:W.at(0).status,status_note:null===e||void 0===e?void 0:e.status_note};q.Z.changeStatus(null===W||void 0===W?void 0:W.at(0).id,t).then((function(){j.Am.success(M("successfully.changed")),V((0,C.aw)(H)),U(!1),R(null)})).finally((function(){N(!1),B(!1)}))},ce={selectedRowKeys:W,onChange:function(e){R(e)}};return(0,F.jsxs)(m.Z,{title:M("requests"),extra:(0,F.jsx)(u.Z,{wrap:!0,children:(0,F.jsx)(b.Z,{columns:de,setColumns:se})}),children:[(0,F.jsx)(f.Z,{scroll:{x:!0},rowSelection:ce,columns:null===de||void 0===de?void 0:de.filter((function(e){return e.is_show})),dataSource:X,pagination:{pageSize:ne.perPage,page:(null===(t=J.data)||void 0===t?void 0:t.page)||1,total:ee.total,defaultCurrent:null===(n=J.data)||void 0===n?void 0:n.page,current:null===(l=J.data)||void 0===l?void 0:l.page},rowKey:function(e){return e.key},onChange:function(e,t,n){var i=e.pageSize,a=e.current,l=n.field,r=n.order,o=(0,_.Z)(r);V((0,Z.nc)({activeMenu:J,data:(0,s.Z)((0,s.Z)({},J.data),{},{perPage:i,page:a,column:l,sort:o})}))},loading:te}),(0,F.jsx)(y.Z,{click:ue,text:M("change.status"),setText:R,loading:z}),(0,F.jsx)(Y,{data:{title:"decline"},visible:K,handleCancel:function(){return N(!1)},handleOk:ue,laoding:z})]})}function N(){var e,t,n=(0,o.$)().t,s=(0,r.TH)(),u=(0,g.I0)(),c=(0,g.v9)((function(e){return e.menu}),g.wU).activeMenu,v=(0,a.useState)((null===(e=s.state)||void 0===e?void 0:e.tab)||"list"),h=(0,i.Z)(v,2),m=h[0],f=h[1];return(0,F.jsxs)(l.Z,{defaultActiveKey:(null===(t=s.state)||void 0===t?void 0:t.tab)||"list",destroyInactiveTabPane:!0,onChange:function(e){u((0,Z.xo)(c)),f(e)},children:[(0,F.jsx)(l.Z.TabPane,{tab:n("category.list"),children:(0,F.jsx)(d.Z,{activeTab:m})},"list"),(0,F.jsx)(l.Z.TabPane,{tab:n("requests"),children:(0,F.jsx)(K,{activeTab:m})},"request")]})}}}]);