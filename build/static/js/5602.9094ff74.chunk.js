"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[5602],{15602:function(e,n,t){t.r(n),t.d(n,{default:function(){return R}});var l=t(4942),i=t(93433),d=t(1413),o=t(29439),a=t(47313),u=t(47548),r=t(31741),s=t(12019),c=t(66407),f=t(47515),v=t(55768),h=t(73591),m=t(45705),Z=t(59491),x=t(77181),j=t(78508),p=t(97890),g=t(2717),_=t(84304),b=t(13945),y=t(90954),C=t(80314),w=t(91405),k=t(24511),S=t(10310),A=t(41481),I=t(53233),M=t(55940),P=t(74580),L=t(23560),N=t(45321),T=t(69658),U=t(48008),z=t(26672),K=t(49986),O=t(79492),D=t(4014),V=t(46417),E=h.Z.TabPane,F=["admin","seller","moderator","manager","cook","deliveryman","waiter","deleted_at"];function R(){var e,n,t,R,$,q,B,G=(0,k.$)().t,H=(0,g.I0)(),J=(0,p.s0)(),Q=(0,a.useState)(null),W=(0,o.Z)(Q,2),X=W[0],Y=W[1],ee=(0,a.useState)(null),ne=(0,o.Z)(ee,2),te=ne[0],le=ne[1],ie=(0,a.useContext)(P._).setIsModalVisible,de=(0,a.useState)(!1),oe=(0,o.Z)(de,2),ae=oe[0],ue=oe[1],re=(0,g.v9)((function(e){return e.menu}),g.wU).activeMenu,se=(0,g.v9)((function(e){return e.user}),g.wU),ce=se.users,fe=se.loading,ve=se.meta,he=se.params,me=(0,a.useState)(null),Ze=(0,o.Z)(me,2),xe=Ze[0],je=Ze[1],pe=(0,a.useState)(null),ge=(0,o.Z)(pe,2),_e=ge[0],be=ge[1],ye=(0,a.useState)("admin"),Ce=(0,o.Z)(ye,2),we=Ce[0],ke=Ce[1],Se=(0,a.useState)(null),Ae=(0,o.Z)(Se,2),Ie=Ae[0],Me=Ae[1],Pe=(null===(e=re.data)||void 0===e?void 0:e.role)||we,Le=(0,g.v9)((function(e){return e.auth}),g.wU).user,Ne=(0,O.Z)(),Te=Ne.isDemo,Ue=Ne.demoDeliveryman,ze=Ne.demoSeller,Ke=Ne.demoAdmin,Oe=Ne.demoModerator,De=Ne.demoMeneger,Ve=re.data,Ee="deleted_at"===Pe?{deleted_at:1,role:null}:{role:Pe},Fe=(0,d.Z)((0,d.Z)({sort:null===Ve||void 0===Ve?void 0:Ve.sort,column:null===Ve||void 0===Ve?void 0:Ve.column},Ee),{},{perPage:null===Ve||void 0===Ve?void 0:Ve.perPage,page:null===Ve||void 0===Ve?void 0:Ve.page,search:null===Ve||void 0===Ve?void 0:Ve.search}),Re=(0,a.useState)([{title:G("id"),dataIndex:"id",sorter:!0,is_show:!0},{title:G("firstname"),dataIndex:"firstname",is_show:!0},{title:G("lastname"),dataIndex:"lastname",is_show:!0},{title:G("email"),dataIndex:"email",is_show:!0,render:function(e){return(0,V.jsx)("div",{children:Te?(0,D.Z)(e):e})}},{title:G("role"),dataIndex:"role",is_show:!0},{title:G("options"),dataIndex:"options",is_show:!0,render:function(e,n){return(0,V.jsxs)(m.Z,{children:[(0,V.jsx)(Z.Z,{icon:(0,V.jsx)(u.Z,{}),onClick:function(){return je(n.uuid)},disabled:null===n||void 0===n?void 0:n.deleted_at}),"manager"===Le.role&&"admin"===n.role?void 0:(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(Z.Z,{icon:(0,V.jsx)(r.Z,{}),onClick:function(){return function(e){H((0,y.bL)({url:"/users/user/".concat(e.uuid),id:"user_info",name:G("user.info")})),J("/users/user/".concat(e.uuid),{state:{user_id:e.id}})}(n)},disabled:null===n||void 0===n?void 0:n.deleted_at}),(0,V.jsx)(Z.Z,{type:"primary",icon:(0,V.jsx)(s.Z,{}),onClick:function(){return function(e){H((0,y.bL)({url:"user/".concat(e.uuid),id:"user_edit",name:"User edit"})),J("/user/".concat(e.uuid))}(n)},disabled:Te&&(null===n||void 0===n?void 0:n.id)==Ue||Te&&(null===n||void 0===n?void 0:n.id)==Oe||Te&&(null===n||void 0===n?void 0:n.id)==De||Te&&(null===n||void 0===n?void 0:n.id)==ze||Te&&(null===n||void 0===n?void 0:n.id)==Ke||(null===n||void 0===n?void 0:n.deleted_at)})]}),"admin"!==(null===n||void 0===n?void 0:n.role)&&(0,V.jsxs)(m.Z,{children:[(0,V.jsx)(Z.Z,{icon:(0,V.jsx)(c.Z,{}),onClick:function(){return function(e){H((0,y.bL)({url:"user-clone/".concat(e.uuid),id:"user-clone",name:"user.clone"})),J("/user-clone/".concat(e.uuid))}(n)},disabled:null===n||void 0===n?void 0:n.deleted_at}),(0,V.jsx)(M.Z,{icon:(0,V.jsx)(f.Z,{}),onClick:function(){Y([n.id]),ie(!0),le(!0)},disabled:null===n||void 0===n?void 0:n.deleted_at})]})]})}}]),$e=(0,o.Z)(Re,2),qe=$e[0],Be=$e[1];(0,a.useEffect)((function(){re.refetch&&(H((0,_.uh)(Fe)),H((0,y.A_)(re)))}),[re.refetch]),(0,C.Z)((function(){H((0,_.uh)(Fe))}),[re.data]);var Ge=function(e){var n=re.data;H((0,y.nc)({activeMenu:re,data:(0,d.Z)((0,d.Z)({},n),e)}))},He={selectedRowKeys:X,onChange:function(e){Y(e)}};return(0,V.jsxs)(x.Z,{title:G("users"),extra:(0,V.jsxs)(m.Z,{wrap:!0,children:["deleted_at"!==(null===(n=re.data)||void 0===n?void 0:n.role)?(0,V.jsxs)(m.Z,{children:[(0,V.jsx)(M.Z,{size:"",onClick:function(){null===X||0===X.length?L.Am.warning(G("select.the.product")):(ie(!0),le(!1))},children:G("delete.selected")}),(0,V.jsx)(M.Z,{onClick:function(){return Me({delete:!0})},children:G("delete.all")})]}):(0,V.jsx)(M.Z,{icon:(0,V.jsx)(z.uOc,{className:"mr-2"}),onClick:function(){return Me({restore:!0})},children:G("restore.all")}),(0,V.jsx)(I.Z,{columns:qe,setColumns:Be})]}),children:[(0,V.jsx)("div",{className:"d-flex justify-content-between mb-3",children:(0,V.jsx)(A.Z,{placeholder:G("search"),className:"w-25",handleChange:function(e){Ge({search:e})},defaultValue:null===(t=re.data)||void 0===t?void 0:t.search,resetSearch:!(null!==(R=re.data)&&void 0!==R&&R.search)})}),(0,V.jsx)(h.Z,{scroll:{x:!0},activeKey:Pe,onChange:function(e){Ge({role:e,page:1}),ke(e)},type:"card",children:F.map((function(e){return(0,V.jsx)(E,{tab:G(e)},e)}))}),"admin"!=Pe&&"seller"!=Pe&&"deleted_at"!=Pe?(0,V.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,V.jsx)(Z.Z,{type:"primary",icon:(0,V.jsx)(v.Z,{}),onClick:function(){return e=Pe,H((0,y.bL)({id:"user-add-role",url:"user/add/".concat(e),name:G("add.".concat(e))})),void J("/user/add/".concat(e));var e},className:"mr-2",children:G("add.".concat(Pe))})}):null,(0,V.jsx)(j.Z,{scroll:{x:!0},rowSelection:He,columns:null===qe||void 0===qe?void 0:qe.filter((function(e){return e.is_show})),dataSource:ce,loading:fe,pagination:{pageSize:he.perPage,page:(null===($=re.data)||void 0===$?void 0:$.page)||1,total:ve.total,defaultCurrent:null===(q=re.data)||void 0===q?void 0:q.page,current:null===(B=re.data)||void 0===B?void 0:B.page},rowKey:function(e){return e.id},onChange:function(e,n,t){var l=e.pageSize,i=e.current,o=t.field,a=t.order,u=(0,b.Z)(a);H((0,y.nc)({activeMenu:re,data:(0,d.Z)((0,d.Z)({},re.data),{},{perPage:l,page:i,column:o,sort:u})}))}}),(0,V.jsx)(T.Z,{click:function(){ue(!0);var e=(0,d.Z)({},Object.assign.apply(Object,[{}].concat((0,i.Z)(X.map((function(e,n){return(0,l.Z)({},"ids[".concat(n,"]"),e)}))))));N.Z.delete(e).then((function(){L.Am.success(G("successfully.deleted")),H((0,_.uh)(Fe)),ie(!1),le([])})).finally((function(){Y(null),ue(!1)}))},text:G(te?"delete":"all.delete"),loading:ae,setText:Y}),xe&&(0,V.jsx)(w.Z,{uuid:xe,handleCancel:function(){return je(null)}}),_e&&(0,V.jsx)(S.Z,{data:_e,handleCancel:function(){return be(null)}}),Ie&&(0,V.jsx)(U.Z,{open:Ie,handleCancel:function(){return Me(null)},click:Ie.restore?function(){ue(!0),K.Z.restoreAll().then((function(){L.Am.success(G("successfully.restored")),H((0,_.uh)(Fe)),Me(null)})).finally((function(){return ue(!1)}))}:function(){ue(!0),K.Z.dropAll().then((function(){L.Am.success(G("successfully.deleted")),H((0,_.uh)()),Me(null)})).finally((function(){return ue(!1)}))},text:Ie.restore?G("restore.modal.text"):G("read.carefully"),subTitle:Ie.restore?"":G("confirm.deletion"),loading:ae,setText:le})]})}}}]);