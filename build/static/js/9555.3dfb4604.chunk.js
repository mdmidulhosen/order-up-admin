"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[9555],{29555:function(t,e,n){n.r(e);var i=n(93433),a=n(4942),l=n(1413),r=n(29439),c=n(47313),o=n(97890),u=n(23560),s=n(83999),d=n(10976),v=n(77181),p=n(72652),f=n(97421),g=n(2717),Z=n(90954),h=n(24511),m=n(73431),_=n(10596),b=n(12545),y=n(46417),j=s.Z.Step;e.default=function(){var t,e,n,k=(0,h.$)().t,x=(0,g.v9)((function(t){return t.menu}),g.wU).activeMenu,S=(0,o.UO)().id,w=(0,g.I0)(),O=(0,g.v9)((function(t){return t.formLang}),g.wU).defaultLang,F=(0,c.useState)((null===(t=x.data)||void 0===t?void 0:t.step)||0),U=(0,r.Z)(F,2),V=U[0],I=U[1],M=function(t){return{name:t,url:f.bV+t}},N=(0,c.useState)(null!==(e=x.data)&&void 0!==e&&e.galleries[0]?[M(x.data.galleries[0].path)]:[]),q=(0,r.Z)(N,2),A=q[0],B=q[1],C=(0,c.useState)(null!==(n=x.data)&&void 0!==n&&n.galleries[1]?[M(x.data.galleries[1].path)]:[]),E=(0,r.Z)(C,2),L=E[0],z=E[1],$=function(){I(V+1)},D=function(){I(V-1)},G=d.Z.useForm(),H=(0,r.Z)(G,1)[0],J=(0,o.s0)(),K=(0,c.useState)(!1),P=(0,r.Z)(K,2),Q=P[0],R=P[1],T=(0,c.useState)(!1),W=(0,r.Z)(T,2),X=W[0],Y=W[1];(0,c.useEffect)((function(){return function(){var t=H.getFieldsValue(!0);w((0,Z.nc)({activeMenu:x,data:t}))}}),[]);var tt=[].concat((0,i.Z)(A),(0,i.Z)(L));return(0,c.useEffect)((function(){x.refetch&&function(t){R(!0),b.Z.getById(t).then((function(t){var e,n,r,c=t.data;H.setFieldsValue((0,l.Z)((0,l.Z)({},c),{},{title:(0,a.Z)({},O,c.translation.title),description:(0,a.Z)({},O,c.translation.description),instruction:Object.assign.apply(Object,[{}].concat((0,i.Z)(c.instructions.map((function(t){return(0,a.Z)({},t.locale,t.title)}))))),ingredient:Object.assign.apply(Object,[{}].concat((0,i.Z)(c.ingredients.map((function(t){return(0,a.Z)({},t.locale,t.title)}))))),nutrition:null===(e=c.nutritions)||void 0===e?void 0:e.map((function(t){var e;return(0,l.Z)({percentage:null===t||void 0===t||null===(e=t.percentage)||void 0===e?void 0:e.toString(),weight:t.weight},Object.assign.apply(Object,[{}].concat((0,i.Z)(t.translations.flatMap((function(t){return(0,a.Z)({},t.locale,t.title)}))))))})),category_id:{value:c.category.id,label:null===(n=c.category.translation)||void 0===n?void 0:n.title},shop_id:{value:c.shop.id,label:null===(r=c.shop.translation)||void 0===r?void 0:r.title},stocks:c.stocks.map((function(t){var e,n;return(0,l.Z)({stock_id:{value:t.id,label:null===t||void 0===t||null===(e=t.product)||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title}},t)}))})),B([M(c.galleries[0].path)]),z([M(c.galleries[1].path)])})).finally((function(){R(!1),w((0,Z.A_)(x))}))}(S)}),[x.refetch]),(0,y.jsx)(v.Z,{title:k("edit.recepe"),extra:(0,y.jsx)(m.Z,{}),children:Q?(0,y.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,y.jsx)(p.Z,{size:"large",className:"py-5"})}):(0,y.jsxs)(d.Z,{layout:"vertical",onFinish:function(t){var e;H.validateFields();var n=(0,l.Z)((0,l.Z)({},t),{},{category_id:t.category_id.value,images:tt.map((function(t){return t.name})),shop_id:t.shop_id.value,active_time:t.active_time.toString(),total_time:t.total_time.toString(),nutrition:t.nutrition.map((function(t){return(0,l.Z)((0,l.Z)({},t),{},{percentage:String(t.percentage),weight:String(t.weight)})})),stocks:null===(e=t.stocks)||void 0===e?void 0:e.map((function(t){return{min_quantity:t.min_quantity,stock_id:t.stock_id.value}}))});Y(!0);var i="catalog/recept";b.Z.update(S,n).then((function(){u.Am.success(k("successfully.updated")),J("/".concat(i)),w((0,Z.ph)((0,l.Z)((0,l.Z)({},x),{},{nextUrl:i})))})).finally((function(){return Y(!1)}))},form:H,initialValues:(0,l.Z)({active:!0},x.data),children:[(0,y.jsx)(s.Z,{current:V,children:_.S.map((function(t){return(0,y.jsx)(j,{title:k(t.title)},t.title)}))}),_.S.map((function(t){var e=t.content;return(0,y.jsx)("div",{className:"steps-content ".concat(t.step!==V+1&&"hidden"),children:(0,y.jsx)(e,{next:$,prev:D,loading:X,image:A,setImage:B,back:L,setBack:z})},t.title)}))]})})}}}]);