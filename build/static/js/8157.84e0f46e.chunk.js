"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[8157],{88157:function(e,t,n){n.r(t),n.d(t,{default:function(){return N}});var o=n(1413),i=n(29439),a=n(47313),l=n(83999),r=n(10976),d=n(77181),u=n(97890),s=n(2717),c=n(24511),v=n(29395),m=n(53456),f=n(35233),_=n(69096),h=n(33834),p=n(90954),g=n(17649),Z=n(70816),y=n.n(Z),S=n(90486),x=n(70250),F=n(23560),j=n(46417),b=l.Z.Step;function N(){var e,t,n,Z,N,w,k,C,H,M,U,Y,E=(0,c.$)().t,L=r.Z.useForm(),A=(0,i.Z)(L,1)[0],D=(0,h.K)(),I=(0,s.I0)(),J=(0,u.s0)(),O=(0,s.v9)((function(e){return e.menu}),s.wU).activeMenu,T=(0,s.v9)((function(e){return e.globalSettings}),s.wU).settings,V=(0,s.v9)((function(e){return e.currency}),s.wU).defaultCurrency,K=Number((null===(e=D.values)||void 0===e?void 0:e.step)||0),$=(0,a.useState)(!1),q=(0,i.Z)($,2),z=q[0],B=q[1],G=(0,a.useState)((null===O||void 0===O||null===(t=O.data)||void 0===t?void 0:t.images)||[]),P=(0,i.Z)(G,2),Q=P[0],R=P[1],W=(0,a.useState)(null!==O&&void 0!==O&&null!==(n=O.data)&&void 0!==n&&n.location_from?{lat:parseFloat(null===O||void 0===O||null===(Z=O.data)||void 0===Z||null===(N=Z.location_from)||void 0===N?void 0:N.latitude),lng:parseFloat(null===O||void 0===O||null===(w=O.data)||void 0===w||null===(k=w.location_from)||void 0===k?void 0:k.longitude)}:(0,g.Z)(T)),X=(0,i.Z)(W,2),ee=X[0],te=X[1],ne=(0,a.useState)(null!==O&&void 0!==O&&null!==(C=O.data)&&void 0!==C&&C.location_to?{lat:parseFloat(null===O||void 0===O||null===(H=O.data)||void 0===H||null===(M=H.location_to)||void 0===M?void 0:M.latitude),lng:parseFloat(null===O||void 0===O||null===(U=O.data)||void 0===U||null===(Y=U.location_to)||void 0===Y?void 0:Y.longitude)}:(0,g.Z)(T)),oe=(0,i.Z)(ne,2),ie=oe[0],ae=oe[1];(0,a.useEffect)((function(){return function(){var e=A.getFieldsValue(!0),t=JSON.stringify(e.delivery_date),n=JSON.stringify(e.delivery_time),i=(0,o.Z)((0,o.Z)({},e),{},{date:t,time:n});I((0,p.nc)({activeMenu:O,data:i}))}}),[]);var le=function(){var e=K+1;D.set("step",e)},re=function(){var e=K-1;D.set("step",e)};return(0,j.jsxs)(d.Z,{title:E("add.parcel.order"),children:[(0,j.jsx)(l.Z,{current:K,onChange:function(e){D.set("step",e)},children:v.S.map((function(e){return(0,j.jsx)(b,{title:E(e.title)},e.title)}))}),(0,j.jsx)("div",{className:"steps-content",children:(0,j.jsxs)(r.Z,{form:A,name:"parcel-create",layout:"vertical",onFinish:function(e){var t,n;console.log("values => ",e),B(!0);var i={user_id:null===(t=e.user_from)||void 0===t?void 0:t.value,currency_id:null===V||void 0===V?void 0:V.id,type_id:null===(n=e.type)||void 0===n?void 0:n.value,rate:null===V||void 0===V?void 0:V.rate,phone_from:e.phone_from.toString(),username_from:e.username_from,address_from:{longitude:null===ee||void 0===ee?void 0:ee.lng,latitude:null===ee||void 0===ee?void 0:ee.lat,address:e.address_from,house:e.house_from,stage:e.stage_from,room:e.room_from},phone_to:e.phone_to.toString(),username_to:e.username_to,address_to:{longitude:null===ie||void 0===ie?void 0:ie.lng,latitude:null===ie||void 0===ie?void 0:ie.lat,address:e.address_to,house:e.house_to,stage:e.stage_to,room:e.room_to},delivery_date:y()(e.delivery_date).format("YYYY-MM-DD"),delivery_time:y()(e.delivery_time,"HH:mm").format("HH:mm"),note:e.note,images:Q.map((function(e){return e.name}))},a={payment_sys_id:e.payment_type.value};S.Z.create(i).then((function(e){return function(e,t){var n="parcel-orders";S.Z.transaction(e,t).then((function(){I((0,x.LF)()),F.Am.success(E("successfully.created")),I((0,p.ph)((0,o.Z)((0,o.Z)({},O),{},{nextUrl:n}))),J("/".concat(n))})).finally((function(){return B(!1)}))}(e.data.id,a)})).catch((function(){return B(!1)}))},initialValues:(0,o.Z)({},O.data),onFinishFailed:function(e){var t=["","",""];e.errorFields.map((function(e){return e.name[0]})).forEach((function(e){e.includes("_from")?t[0]="sender.details.invalid":e.includes("_to")?t[1]="receiver.details.invalid":t[2]="parcel.details.invalid"})),t.forEach((function(e){e&&F.Am.error(E(e))}))},children:[(0,j.jsx)("div",{className:"First-content"===v.S[K].content?"":"d-none",children:(0,j.jsx)(m.Z,{form:A,next:le,location:ee,setLocation:te})}),(0,j.jsx)("div",{className:"Second-content"===v.S[K].content?"":"d-none",children:(0,j.jsx)(f.Z,{form:A,next:le,prev:re,location:ie,setLocation:ae})}),(0,j.jsx)("div",{className:"Third-content"===v.S[K].content?"":"d-none",children:(0,j.jsx)(_.Z,{form:A,loading:z,prev:re,locationFrom:ee,locationTo:ie,image:Q,setImage:R})})]})})]})}}}]);